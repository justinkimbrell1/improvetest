/*! This file is auto-generated */
!function(n,r){var t,e;"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define("underscore",r):(n="undefined"!=typeof globalThis?globalThis:n||self,t=n._,(e=n._=r()).noConflict=function(){return n._=t,e})}(this,function(){var n="1.13.6",r="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},e=Array.prototype,F=Object.prototype,V="undefined"!=typeof Symbol?Symbol.prototype:null,P=e.push,f=e.slice,s=F.toString,q=F.hasOwnProperty,t="undefined"!=typeof ArrayBuffer,u="undefined"!=typeof DataView,U=Array.isArray,W=Object.keys,z=Object.create,L=t&&ArrayBuffer.isView,$=isNaN,C=isFinite,K=!{toString:null}.propertyIsEnumerable("toString"),J=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],G=Math.pow(2,53)-1;function l(u,o){return o=null==o?u.length-1:+o,function(){for(var n=Math.max(arguments.length-o,0),r=Array(n),t=0;t<n;t++)r[t]=arguments[t+o];switch(o){case 0:return u.call(this,r);case 1:return u.call(this,arguments[0],r);case 2:return u.call(this,arguments[0],arguments[1],r)}for(var e=Array(o+1),t=0;t<o;t++)e[t]=arguments[t];return e[o]=r,u.apply(this,e)}}function o(n){var r=typeof n;return"function"==r||"object"==r&&!!n}function H(n){return void 0===n}function Q(n){return!0===n||!1===n||"[object Boolean]"===s.call(n)}function i(n){var r="[object "+n+"]";return function(n){return s.call(n)===r}}var X=i("String"),Y=i("Number"),Z=i("Date"),nn=i("RegExp"),rn=i("Error"),tn=i("Symbol"),en=i("ArrayBuffer"),a=i("Function"),r=r.document&&r.document.childNodes,p=a="function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof r?function(n){return"function"==typeof n||!1}:a,r=i("Object"),un=u&&r(new DataView(new ArrayBuffer(8))),a="undefined"!=typeof Map&&r(new Map),u=i("DataView");var h=un?function(n){return null!=n&&p(n.getInt8)&&en(n.buffer)}:u,v=U||i("Array");function y(n,r){return null!=n&&q.call(n,r)}var on=i("Arguments"),an=(!function(){on(arguments)||(on=function(n){return y(n,"callee")})}(),on);function fn(n){return Y(n)&&$(n)}function cn(n){return function(){return n}}function ln(r){return function(n){n=r(n);return"number"==typeof n&&0<=n&&n<=G}}function sn(r){return function(n){return null==n?void 0:n[r]}}var d=sn("byteLength"),pn=ln(d),hn=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var vn=t?function(n){return L?L(n)&&!h(n):pn(n)&&hn.test(s.call(n))}:cn(!1),g=sn("length");function yn(n,r){r=function(r){for(var t={},n=r.length,e=0;e<n;++e)t[r[e]]=!0;return{contains:function(n){return!0===t[n]},push:function(n){return t[n]=!0,r.push(n)}}}(r);var t=J.length,e=n.constructor,u=p(e)&&e.prototype||F,o="constructor";for(y(n,o)&&!r.contains(o)&&r.push(o);t--;)(o=J[t])in n&&n[o]!==u[o]&&!r.contains(o)&&r.push(o)}function b(n){if(!o(n))return[];if(W)return W(n);var r,t=[];for(r in n)y(n,r)&&t.push(r);return K&&yn(n,t),t}function dn(n,r){var t=b(r),e=t.length;if(null==n)return!e;for(var u=Object(n),o=0;o<e;o++){var i=t[o];if(r[i]!==u[i]||!(i in u))return!1}return!0}function m(n){return n instanceof m?n:this instanceof m?void(this._wrapped=n):new m(n)}function gn(n){return new Uint8Array(n.buffer||n,n.byteOffset||0,d(n))}m.VERSION=n,m.prototype.valueOf=m.prototype.toJSON=m.prototype.value=function(){return this._wrapped},m.prototype.toString=function(){return String(this._wrapped)};var bn="[object DataView]";function mn(n,r,t,e){var u;return n===r?0!==n||1/n==1/r:null!=n&&null!=r&&(n!=n?r!=r:("function"==(u=typeof n)||"object"==u||"object"==typeof r)&&function n(r,t,e,u){r instanceof m&&(r=r._wrapped);t instanceof m&&(t=t._wrapped);var o=s.call(r);if(o!==s.call(t))return!1;if(un&&"[object Object]"==o&&h(r)){if(!h(t))return!1;o=bn}switch(o){case"[object RegExp]":case"[object String]":return""+r==""+t;case"[object Number]":return+r!=+r?+t!=+t:0==+r?1/+r==1/t:+r==+t;case"[object Date]":case"[object Boolean]":return+r==+t;case"[object Symbol]":return V.valueOf.call(r)===V.valueOf.call(t);case"[object ArrayBuffer]":case bn:return n(gn(r),gn(t),e,u)}o="[object Array]"===o;if(!o&&vn(r)){var i=d(r);if(i!==d(t))return!1;if(r.buffer===t.buffer&&r.byteOffset===t.byteOffset)return!0;o=!0}if(!o){if("object"!=typeof r||"object"!=typeof t)return!1;var i=r.constructor,a=t.constructor;if(i!==a&&!(p(i)&&i instanceof i&&p(a)&&a instanceof a)&&"constructor"in r&&"constructor"in t)return!1}e=e||[];u=u||[];var f=e.length;for(;f--;)if(e[f]===r)return u[f]===t;e.push(r);u.push(t);if(o){if((f=r.length)!==t.length)return!1;for(;f--;)if(!mn(r[f],t[f],e,u))return!1}else{var c,l=b(r);if(f=l.length,b(t).length!==f)return!1;for(;f--;)if(c=l[f],!y(t,c)||!mn(r[c],t[c],e,u))return!1}e.pop();u.pop();return!0}(n,r,t,e))}function c(n){if(!o(n))return[];var r,t=[];for(r in n)t.push(r);return K&&yn(n,t),t}function jn(e){var u=g(e);return function(n){if(null==n)return!1;var r=c(n);if(g(r))return!1;for(var t=0;t<u;t++)if(!p(n[e[t]]))return!1;return e!==wn||!p(n[_n])}}var _n="forEach",r=["clear","delete"],u=["get","has","set"],U=r.concat(_n,u),wn=r.concat(u),t=["add"].concat(r,_n,"has"),u=a?jn(U):i("Map"),r=a?jn(wn):i("WeakMap"),U=a?jn(t):i("Set"),a=i("WeakSet");function j(n){for(var r=b(n),t=r.length,e=Array(t),u=0;u<t;u++)e[u]=n[r[u]];return e}function An(n){for(var r={},t=b(n),e=0,u=t.length;e<u;e++)r[n[t[e]]]=t[e];return r}function xn(n){var r,t=[];for(r in n)p(n[r])&&t.push(r);return t.sort()}function Sn(f,c){return function(n){var r=arguments.length;if(c&&(n=Object(n)),!(r<2||null==n))for(var t=1;t<r;t++)for(var e=arguments[t],u=f(e),o=u.length,i=0;i<o;i++){var a=u[i];c&&void 0!==n[a]||(n[a]=e[a])}return n}}var On=Sn(c),_=Sn(b),Mn=Sn(c,!0);function En(n){var r;return o(n)?z?z(n):((r=function(){}).prototype=n,n=new r,r.prototype=null,n):{}}function Bn(n){return v(n)?n:[n]}function w(n){return m.toPath(n)}function Nn(n,r){for(var t=r.length,e=0;e<t;e++){if(null==n)return;n=n[r[e]]}return t?n:void 0}function In(n,r,t){n=Nn(n,w(r));return H(n)?t:n}function Tn(n){return n}function A(r){return r=_({},r),function(n){return dn(n,r)}}function kn(r){return r=w(r),function(n){return Nn(n,r)}}function x(u,o,n){if(void 0===o)return u;switch(null==n?3:n){case 1:return function(n){return u.call(o,n)};case 3:return function(n,r,t){return u.call(o,n,r,t)};case 4:return function(n,r,t,e){return u.call(o,n,r,t,e)}}return function(){return u.apply(o,arguments)}}function Dn(n,r,t){return null==n?Tn:p(n)?x(n,r,t):(o(n)&&!v(n)?A:kn)(n)}function Rn(n,r){return Dn(n,r,1/0)}function S(n,r,t){return m.iteratee!==Rn?m.iteratee(n,r):Dn(n,r,t)}function Fn(){}function Vn(n,r){return null==r&&(r=n,n=0),n+Math.floor(Math.random()*(r-n+1))}m.toPath=Bn,m.iteratee=Rn;var O=Date.now||function(){return(new Date).getTime()};function Pn(r){function t(n){return r[n]}var n="(?:"+b(r).join("|")+")",e=RegExp(n),u=RegExp(n,"g");return function(n){return e.test(n=null==n?"":""+n)?n.replace(u,t):n}}var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},qn=Pn(t),t=Pn(An(t)),Un=m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Wn=/(.)^/,zn={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Ln=/\\|'|\r|\n|\u2028|\u2029/g;function $n(n){return"\\"+zn[n]}var Cn=/^\s*(\w|\$)+\s*$/;var Kn=0;function Jn(n,r,t,e,u){return e instanceof r?(e=En(n.prototype),o(r=n.apply(e,u))?r:e):n.apply(t,u)}var M=l(function(u,o){function i(){for(var n=0,r=o.length,t=Array(r),e=0;e<r;e++)t[e]=o[e]===a?arguments[n++]:o[e];for(;n<arguments.length;)t.push(arguments[n++]);return Jn(u,i,this,this,t)}var a=M.placeholder;return i}),Gn=(M.placeholder=m,l(function(r,t,e){var u;if(p(r))return u=l(function(n){return Jn(r,u,t,this,e.concat(n))});throw new TypeError("Bind must be called on a function")})),E=ln(g);function B(n,r,t,e){if(e=e||[],r||0===r){if(r<=0)return e.concat(n)}else r=1/0;for(var u=e.length,o=0,i=g(n);o<i;o++){var a=n[o];if(E(a)&&(v(a)||an(a)))if(1<r)B(a,r-1,t,e),u=e.length;else for(var f=0,c=a.length;f<c;)e[u++]=a[f++];else t||(e[u++]=a)}return e}var Hn=l(function(n,r){var t=(r=B(r,!1,!1)).length;if(t<1)throw new Error("bindAll must be passed function names");for(;t--;){var e=r[t];n[e]=Gn(n[e],n)}return n});var Qn=l(function(n,r,t){return setTimeout(function(){return n.apply(null,t)},r)}),Xn=M(Qn,m,1);function Yn(n){return function(){return!n.apply(this,arguments)}}function Zn(n,r){var t;return function(){return 0<--n&&(t=r.apply(this,arguments)),n<=1&&(r=null),t}}var nr=M(Zn,2);function rr(n,r,t){r=S(r,t);for(var e,u=b(n),o=0,i=u.length;o<i;o++)if(r(n[e=u[o]],e,n))return e}function tr(o){return function(n,r,t){r=S(r,t);for(var e=g(n),u=0<o?0:e-1;0<=u&&u<e;u+=o)if(r(n[u],u,n))return u;return-1}}var er=tr(1),ur=tr(-1);function or(n,r,t,e){for(var u=(t=S(t,e,1))(r),o=0,i=g(n);o<i;){var a=Math.floor((o+i)/2);t(n[a])<u?o=a+1:i=a}return o}function ir(o,i,a){return function(n,r,t){var e=0,u=g(n);if("number"==typeof t)0<o?e=0<=t?t:Math.max(t+u,e):u=0<=t?Math.min(t+1,u):t+u+1;else if(a&&t&&u)return n[t=a(n,r)]===r?t:-1;if(r!=r)return 0<=(t=i(f.call(n,e,u),fn))?t+e:-1;for(t=0<o?e:u-1;0<=t&&t<u;t+=o)if(n[t]===r)return t;return-1}}var ar=ir(1,er,or),fr=ir(-1,ur);function cr(n,r,t){r=(E(n)?er:rr)(n,r,t);if(void 0!==r&&-1!==r)return n[r]}function N(n,r,t){if(r=x(r,t),E(n))for(u=0,o=n.length;u<o;u++)r(n[u],u,n);else for(var e=b(n),u=0,o=e.length;u<o;u++)r(n[e[u]],e[u],n);return n}function I(n,r,t){r=S(r,t);for(var e=!E(n)&&b(n),u=(e||n).length,o=Array(u),i=0;i<u;i++){var a=e?e[i]:i;o[i]=r(n[a],a,n)}return o}function lr(p){return function(n,r,t,e){var u=3<=arguments.length,o=n,i=x(r,e,4),a=t,f=!E(o)&&b(o),c=(f||o).length,l=0<p?0:c-1;for(u||(a=o[f?f[l]:l],l+=p);0<=l&&l<c;l+=p){var s=f?f[l]:l;a=i(a,o[s],s,o)}return a}}var sr=lr(1),pr=lr(-1);function T(n,e,r){var u=[];return e=S(e,r),N(n,function(n,r,t){e(n,r,t)&&u.push(n)}),u}function hr(n,r,t){r=S(r,t);for(var e=!E(n)&&b(n),u=(e||n).length,o=0;o<u;o++){var i=e?e[o]:o;if(!r(n[i],i,n))return!1}return!0}function vr(n,r,t){r=S(r,t);for(var e=!E(n)&&b(n),u=(e||n).length,o=0;o<u;o++){var i=e?e[o]:o;if(r(n[i],i,n))return!0}return!1}function k(n,r,t,e){return E(n)||(n=j(n)),0<=ar(n,r,t="number"==typeof t&&!e?t:0)}var yr=l(function(n,t,e){var u,o;return p(t)?o=t:(t=w(t),u=t.slice(0,-1),t=t[t.length-1]),I(n,function(n){var r=o;if(!r){if(null==(n=u&&u.length?Nn(n,u):n))return;r=n[t]}return null==r?r:r.apply(n,e)})});function dr(n,r){return I(n,kn(r))}function gr(n,e,r){var t,u,o=-1/0,i=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof n[0]&&null!=n)for(var a=0,f=(n=E(n)?n:j(n)).length;a<f;a++)null!=(t=n[a])&&o<t&&(o=t);else e=S(e,r),N(n,function(n,r,t){u=e(n,r,t),(i<u||u===-1/0&&o===-1/0)&&(o=n,i=u)});return o}var br=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function mr(n){return n?v(n)?f.call(n):X(n)?n.match(br):E(n)?I(n,Tn):j(n):[]}function jr(n,r,t){if(null==r||t)return(n=E(n)?n:j(n))[Vn(n.length-1)];for(var e=mr(n),t=g(e),u=(r=Math.max(Math.min(r,t),0),t-1),o=0;o<r;o++){var i=Vn(o,u),a=e[o];e[o]=e[i],e[i]=a}return e.slice(0,r)}function D(o,r){return function(t,e,n){var u=r?[[],[]]:{};return e=S(e,n),N(t,function(n,r){r=e(n,r,t);o(u,n,r)}),u}}var _r=D(function(n,r,t){y(n,t)?n[t].push(r):n[t]=[r]}),wr=D(function(n,r,t){n[t]=r}),Ar=D(function(n,r,t){y(n,t)?n[t]++:n[t]=1}),xr=D(function(n,r,t){n[t?0:1].push(r)},!0);function Sr(n,r,t){return r in t}var Or=l(function(n,r){var t={},e=r[0];if(null!=n){p(e)?(1<r.length&&(e=x(e,r[1])),r=c(n)):(e=Sr,r=B(r,!1,!1),n=Object(n));for(var u=0,o=r.length;u<o;u++){var i=r[u],a=n[i];e(a,i,n)&&(t[i]=a)}}return t}),Mr=l(function(n,t){var r,e=t[0];return p(e)?(e=Yn(e),1<t.length&&(r=t[1])):(t=I(B(t,!1,!1),String),e=function(n,r){return!k(t,r)}),Or(n,e,r)});function Er(n,r,t){return f.call(n,0,Math.max(0,n.length-(null==r||t?1:r)))}function Br(n,r,t){return null==n||n.length<1?null==r||t?void 0:[]:null==r||t?n[0]:Er(n,n.length-r)}function R(n,r,t){return f.call(n,null==r||t?1:r)}var Nr=l(function(n,r){return r=B(r,!0,!0),T(n,function(n){return!k(r,n)})}),Ir=l(function(n,r){return Nr(n,r)});function Tr(n,r,t,e){Q(r)||(e=t,t=r,r=!1),null!=t&&(t=S(t,e));for(var u=[],o=[],i=0,a=g(n);i<a;i++){var f=n[i],c=t?t(f,i,n):f;r&&!t?(i&&o===c||u.push(f),o=c):t?k(o,c)||(o.push(c),u.push(f)):k(u,f)||u.push(f)}return u}var kr=l(function(n){return Tr(B(n,!0,!0))});function Dr(n){for(var r=n&&gr(n,g).length||0,t=Array(r),e=0;e<r;e++)t[e]=dr(n,e);return t}var Rr=l(Dr);function Fr(n,r){return n._chain?m(r).chain():r}function Vr(t){return N(xn(t),function(n){var r=m[n]=t[n];m.prototype[n]=function(){var n=[this._wrapped];return P.apply(n,arguments),Fr(this,r.apply(m,n))}}),m}N(["pop","push","reverse","shift","sort","splice","unshift"],function(r){var t=e[r];m.prototype[r]=function(){var n=this._wrapped;return null!=n&&(t.apply(n,arguments),"shift"!==r&&"splice"!==r||0!==n.length||delete n[0]),Fr(this,n)}}),N(["concat","join","slice"],function(n){var r=e[n];m.prototype[n]=function(){var n=this._wrapped;return Fr(this,n=null!=n?r.apply(n,arguments):n)}});n=Vr({__proto__:null,VERSION:n,restArguments:l,isObject:o,isNull:function(n){return null===n},isUndefined:H,isBoolean:Q,isElement:function(n){return!(!n||1!==n.nodeType)},isString:X,isNumber:Y,isDate:Z,isRegExp:nn,isError:rn,isSymbol:tn,isArrayBuffer:en,isDataView:h,isArray:v,isFunction:p,isArguments:an,isFinite:function(n){return!tn(n)&&C(n)&&!isNaN(parseFloat(n))},isNaN:fn,isTypedArray:vn,isEmpty:function(n){var r;return null==n||("number"==typeof(r=g(n))&&(v(n)||X(n)||an(n))?0===r:0===g(b(n)))},isMatch:dn,isEqual:function(n,r){return mn(n,r)},isMap:u,isWeakMap:r,isSet:U,isWeakSet:a,keys:b,allKeys:c,values:j,pairs:function(n){for(var r=b(n),t=r.length,e=Array(t),u=0;u<t;u++)e[u]=[r[u],n[r[u]]];return e},invert:An,functions:xn,methods:xn,extend:On,extendOwn:_,assign:_,defaults:Mn,create:function(n,r){return n=En(n),r&&_(n,r),n},clone:function(n){return o(n)?v(n)?n.slice():On({},n):n},tap:function(n,r){return r(n),n},get:In,has:function(n,r){for(var t=(r=w(r)).length,e=0;e<t;e++){var u=r[e];if(!y(n,u))return!1;n=n[u]}return!!t},mapObject:function(n,r,t){r=S(r,t);for(var e=b(n),u=e.length,o={},i=0;i<u;i++){var a=e[i];o[a]=r(n[a],a,n)}return o},identity:Tn,constant:cn,noop:Fn,toPath:Bn,property:kn,propertyOf:function(r){return null==r?Fn:function(n){return In(r,n)}},matcher:A,matches:A,times:function(n,r,t){var e=Array(Math.max(0,n));r=x(r,t,1);for(var u=0;u<n;u++)e[u]=r(u);return e},random:Vn,now:O,escape:qn,unescape:t,templateSettings:Un,template:function(o,n,r){n=Mn({},n=!n&&r?r:n,m.templateSettings);var t,r=RegExp([(n.escape||Wn).source,(n.interpolate||Wn).source,(n.evaluate||Wn).source].join("|")+"|$","g"),i=0,a="__p+='";if(o.replace(r,function(n,r,t,e,u){return a+=o.slice(i,u).replace(Ln,$n),i=u+n.length,r?a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":t?a+="'+\n((__t=("+t+"))==null?'':__t)+\n'":e&&(a+="';\n"+e+"\n__p+='"),n}),a+="';\n",r=n.variable){if(!Cn.test(r))throw new Error("variable is not a bare identifier: "+r)}else a="with(obj||{}){\n"+a+"}\n",r="obj";a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{t=new Function(r,"_",a)}catch(n){throw n.source=a,n}function e(n){return t.call(this,n,m)}return e.source="function("+r+"){\n"+a+"}",e},result:function(n,r,t){var e=(r=w(r)).length;if(!e)return p(t)?t.call(n):t;for(var u=0;u<e;u++){var o=null==n?void 0:n[r[u]];void 0===o&&(o=t,u=e),n=p(o)?o.call(n):o}return n},uniqueId:function(n){var r=++Kn+"";return n?n+r:r},chain:function(n){return(n=m(n))._chain=!0,n},iteratee:Rn,partial:M,bind:Gn,bindAll:Hn,memoize:function(e,u){function o(n){var r=o.cache,t=""+(u?u.apply(this,arguments):n);return y(r,t)||(r[t]=e.apply(this,arguments)),r[t]}return o.cache={},o},delay:Qn,defer:Xn,throttle:function(t,e,u){function o(){l=!1===u.leading?0:O(),i=null,c=t.apply(a,f),i||(a=f=null)}function n(){var n=O(),r=(l||!1!==u.leading||(l=n),e-(n-l));return a=this,f=arguments,r<=0||e<r?(i&&(clearTimeout(i),i=null),l=n,c=t.apply(a,f),i||(a=f=null)):i||!1===u.trailing||(i=setTimeout(o,r)),c}var i,a,f,c,l=0;return u=u||{},n.cancel=function(){clearTimeout(i),l=0,i=a=f=null},n},debounce:function(r,t,e){function u(){var n=O()-i;n<t?o=setTimeout(u,t-n):(o=null,e||(f=r.apply(c,a)),o||(a=c=null))}var o,i,a,f,c,n=l(function(n){return c=this,a=n,i=O(),o||(o=setTimeout(u,t),e&&(f=r.apply(c,a))),f});return n.cancel=function(){clearTimeout(o),o=a=c=null},n},wrap:function(n,r){return M(r,n)},negate:Yn,compose:function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},after:function(n,r){return function(){if(--n<1)return r.apply(this,arguments)}},before:Zn,once:nr,findKey:rr,findIndex:er,findLastIndex:ur,sortedIndex:or,indexOf:ar,lastIndexOf:fr,find:cr,detect:cr,findWhere:function(n,r){return cr(n,A(r))},each:N,forEach:N,map:I,collect:I,reduce:sr,foldl:sr,inject:sr,reduceRight:pr,foldr:pr,filter:T,select:T,reject:function(n,r,t){return T(n,Yn(S(r)),t)},every:hr,all:hr,some:vr,any:vr,contains:k,includes:k,include:k,invoke:yr,pluck:dr,where:function(n,r){return T(n,A(r))},max:gr,min:function(n,e,r){var t,u,o=1/0,i=1/0;if(null==e||"number"==typeof e&&"object"!=typeof n[0]&&null!=n)for(var a=0,f=(n=E(n)?n:j(n)).length;a<f;a++)null!=(t=n[a])&&t<o&&(o=t);else e=S(e,r),N(n,function(n,r,t){((u=e(n,r,t))<i||u===1/0&&o===1/0)&&(o=n,i=u)});return o},shuffle:function(n){return jr(n,1/0)},sample:jr,sortBy:function(n,e,r){var u=0;return e=S(e,r),dr(I(n,function(n,r,t){return{value:n,index:u++,criteria:e(n,r,t)}}).sort(function(n,r){var t=n.criteria,e=r.criteria;if(t!==e){if(e<t||void 0===t)return 1;if(t<e||void 0===e)return-1}return n.index-r.index}),"value")},groupBy:_r,indexBy:wr,countBy:Ar,partition:xr,toArray:mr,size:function(n){return null==n?0:(E(n)?n:b(n)).length},pick:Or,omit:Mr,first:Br,head:Br,take:Br,initial:Er,last:function(n,r,t){return null==n||n.length<1?null==r||t?void 0:[]:null==r||t?n[n.length-1]:R(n,Math.max(0,n.length-r))},rest:R,tail:R,drop:R,compact:function(n){return T(n,Boolean)},flatten:function(n,r){return B(n,r,!1)},without:Ir,uniq:Tr,unique:Tr,union:kr,intersection:function(n){for(var r=[],t=arguments.length,e=0,u=g(n);e<u;e++){var o=n[e];if(!k(r,o)){for(var i=1;i<t&&k(arguments[i],o);i++);i===t&&r.push(o)}}return r},difference:Nr,unzip:Dr,transpose:Dr,zip:Rr,object:function(n,r){for(var t={},e=0,u=g(n);e<u;e++)r?t[n[e]]=r[e]:t[n[e][0]]=n[e][1];return t},range:function(n,r,t){null==r&&(r=n||0,n=0),t=t||(r<n?-1:1);for(var e=Math.max(Math.ceil((r-n)/t),0),u=Array(e),o=0;o<e;o++,n+=t)u[o]=n;return u},chunk:function(n,r){if(null==r||r<1)return[];for(var t=[],e=0,u=n.length;e<u;)t.push(f.call(n,e,e+=r));return t},mixin:Vr,default:m});return n._=n});;
/*! This file is auto-generated */
!function(n){var s="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(t,e,i){s.Backbone=n(s,i,t,e)});else if("undefined"!=typeof exports){var t,e=require("underscore");try{t=require("jquery")}catch(t){}n(s,exports,e,t)}else s.Backbone=n(s,{},s._,s.jQuery||s.Zepto||s.ender||s.$)}(function(t,h,b,e){function a(t,e,i,n,s){var r,o=0;if(i&&"object"==typeof i){void 0!==n&&"context"in s&&void 0===s.context&&(s.context=n);for(r=b.keys(i);o<r.length;o++)e=a(t,e,r[o],i[r[o]],s)}else if(i&&c.test(i))for(r=i.split(c);o<r.length;o++)e=t(e,r[o],n,s);else e=t(e,i,n,s);return e}function x(t,e,i){i=Math.min(Math.max(i,0),t.length);for(var n=Array(t.length-i),s=e.length,r=0;r<n.length;r++)n[r]=t[r+i];for(r=0;r<s;r++)t[r+i]=e[r];for(r=0;r<n.length;r++)t[r+s+i]=n[r]}function s(i,n,t,s){b.each(t,function(t,e){n[e]&&(i.prototype[e]=function(n,t,s,r){switch(t){case 1:return function(){return n[s](this[r])};case 2:return function(t){return n[s](this[r],t)};case 3:return function(t,e){return n[s](this[r],T(t,this),e)};case 4:return function(t,e,i){return n[s](this[r],T(t,this),e,i)};default:return function(){var t=l.call(arguments);return t.unshift(this[r]),n[s].apply(n,t)}}}(n,t,e,s))})}var o,i=t.Backbone,l=Array.prototype.slice,e=(h.VERSION="1.5.0",h.$=e,h.noConflict=function(){return t.Backbone=i,this},h.emulateHTTP=!1,h.emulateJSON=!1,h.Events={}),c=/\s+/,n=(e.on=function(t,e,i){return this._events=a(n,this._events||{},t,e,{context:i,ctx:this,listening:o}),o&&(((this._listeners||(this._listeners={}))[o.id]=o).interop=!1),this},e.listenTo=function(t,e,i){if(t){var n=t._listenId||(t._listenId=b.uniqueId("l")),s=this._listeningTo||(this._listeningTo={}),r=o=s[n],s=(r||(this._listenId||(this._listenId=b.uniqueId("l")),r=o=s[n]=new g(this,t)),u(t,e,i,this));if(o=void 0,s)throw s;r.interop&&r.on(e,i)}return this},function(t,e,i,n){var s,r;return i&&(e=t[e]||(t[e]=[]),s=n.context,r=n.ctx,(n=n.listening)&&n.count++,e.push({callback:i,context:s,ctx:s||r,listening:n})),t}),u=function(t,e,i,n){try{t.on(e,i,n)}catch(t){return t}},r=(e.off=function(t,e,i){return this._events&&(this._events=a(r,this._events,t,e,{context:i,listeners:this._listeners})),this},e.stopListening=function(t,e,i){var n=this._listeningTo;if(n){for(var s=t?[t._listenId]:b.keys(n),r=0;r<s.length;r++){var o=n[s[r]];if(!o)break;o.obj.off(e,i,this),o.interop&&o.off(e,i)}b.isEmpty(n)&&(this._listeningTo=void 0)}return this},function(t,e,i,n){if(t){var s,r=n.context,o=n.listeners,h=0;if(e||r||i){for(s=e?[e]:b.keys(t);h<s.length;h++){var a=t[e=s[h]];if(!a)break;for(var l=[],c=0;c<a.length;c++){var u=a[c];i&&i!==u.callback&&i!==u.callback._callback||r&&r!==u.context?l.push(u):(u=u.listening)&&u.off(e,i)}l.length?t[e]=l:delete t[e]}return t}for(s=b.keys(o);h<s.length;h++)o[s[h]].cleanup()}}),d=(e.once=function(t,e,i){var n=a(d,{},t,e,this.off.bind(this));return this.on(n,e="string"==typeof t&&null==i?void 0:e,i)},e.listenToOnce=function(t,e,i){e=a(d,{},e,i,this.stopListening.bind(this,t));return this.listenTo(t,e)},function(t,e,i,n){var s;return i&&((s=t[e]=b.once(function(){n(e,s),i.apply(this,arguments)}))._callback=i),t}),f=(e.trigger=function(t){if(this._events){for(var e=Math.max(0,arguments.length-1),i=Array(e),n=0;n<e;n++)i[n]=arguments[n+1];a(f,this._events,t,void 0,i)}return this},function(t,e,i,n){var s,r;return t&&(s=t[e],r=t.all,s&&(r=r&&r.slice()),s&&p(s,n),r)&&p(r,[e].concat(n)),t}),p=function(t,e){var i,n=-1,s=t.length,r=e[0],o=e[1],h=e[2];switch(e.length){case 0:for(;++n<s;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r);return;case 2:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,o);return;case 3:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,o,h);return;default:for(;++n<s;)(i=t[n]).callback.apply(i.ctx,e);return}},g=function(t,e){this.id=t._listenId,this.listener=t,this.obj=e,this.interop=!0,this.count=0,this._events=void 0},v=(g.prototype.on=e.on,g.prototype.off=function(t,e){t=this.interop?(this._events=a(r,this._events,t,e,{context:void 0,listeners:void 0}),!this._events):(this.count--,0===this.count);t&&this.cleanup()},g.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},e.bind=e.on,e.unbind=e.off,b.extend(h,e),h.Model=function(t,e){var i=t||{},n=(e=e||{},this.preinitialize.apply(this,arguments),this.cid=b.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),b.result(this,"defaults")),i=b.defaults(b.extend({},n,i),n);this.set(i,e),this.changed={},this.initialize.apply(this,arguments)}),m=(b.extend(v.prototype,e,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(t){return b.clone(this.attributes)},sync:function(){return h.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return b.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!b.iteratee(t,this)(this.attributes)},set:function(t,e,i){if(null!=t){var n;if("object"==typeof t?(n=t,i=e):(n={})[t]=e,!this._validate(n,i=i||{}))return!1;var s,r,o=i.unset,t=i.silent,h=[],a=this._changing,l=(this._changing=!0,a||(this._previousAttributes=b.clone(this.attributes),this.changed={}),this.attributes),c=this.changed,u=this._previousAttributes;for(s in n)e=n[s],b.isEqual(l[s],e)||h.push(s),b.isEqual(u[s],e)?delete c[s]:c[s]=e,o?delete l[s]:l[s]=e;if(this.idAttribute in n&&(r=this.id,this.id=this.get(this.idAttribute),this.trigger("changeId",this,r,i)),!t){h.length&&(this._pending=i);for(var d=0;d<h.length;d++)this.trigger("change:"+h[d],this,l[h[d]],i)}if(!a){if(!t)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);this._pending=!1,this._changing=!1}}return this},unset:function(t,e){return this.set(t,void 0,b.extend({},e,{unset:!0}))},clear:function(t){var e,i={};for(e in this.attributes)i[e]=void 0;return this.set(i,b.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!b.isEmpty(this.changed):b.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&b.clone(this.changed);var e,i,n=this._changing?this._previousAttributes:this.attributes,s={};for(i in t){var r=t[i];b.isEqual(n[i],r)||(s[i]=r,e=!0)}return!!e&&s},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return b.clone(this._previousAttributes)},fetch:function(i){i=b.extend({parse:!0},i);var n=this,s=i.success;return i.success=function(t){var e=i.parse?n.parse(t,i):t;if(!n.set(e,i))return!1;s&&s.call(i.context,n,t,i),n.trigger("sync",n,t,i)},N(this,i),this.sync("read",this,i)},save:function(t,e,i){null==t||"object"==typeof t?(n=t,i=e):(n={})[t]=e;var n,s=(i=b.extend({validate:!0,parse:!0},i)).wait;if(n&&!s){if(!this.set(n,i))return!1}else if(!this._validate(n,i))return!1;var r=this,o=i.success,h=this.attributes,t=(i.success=function(t){r.attributes=h;var e=i.parse?r.parse(t,i):t;if((e=s?b.extend({},n,e):e)&&!r.set(e,i))return!1;o&&o.call(i.context,r,t,i),r.trigger("sync",r,t,i)},N(this,i),n&&s&&(this.attributes=b.extend({},h,n)),this.isNew()?"create":i.patch?"patch":"update"),e=("patch"!=t||i.attrs||(i.attrs=n),this.sync(t,this,i));return this.attributes=h,e},destroy:function(e){e=e?b.clone(e):{};function i(){n.stopListening(),n.trigger("destroy",n,n.collection,e)}var n=this,s=e.success,r=e.wait,t=!(e.success=function(t){r&&i(),s&&s.call(e.context,n,t,e),n.isNew()||n.trigger("sync",n,t,e)});return this.isNew()?b.defer(e.success):(N(this,e),t=this.sync("delete",this,e)),r||i(),t},url:function(){var t,e=b.result(this,"urlRoot")||b.result(this.collection,"url")||R();return this.isNew()?e:(t=this.get(this.idAttribute),e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t))},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},b.extend({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=b.extend({},this.attributes,t);t=this.validationError=this.validate(t,e)||null;return!t||(this.trigger("invalid",this,t,b.extend(e,{validationError:t})),!1)}}),h.Collection=function(t,e){e=e||{},this.preinitialize.apply(this,arguments),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,b.extend({silent:!0},e))}),w={add:!0,remove:!0,merge:!0},_={add:!0,remove:!1},y=(b.extend(m.prototype,e,{model:v,preinitialize:function(){},initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return h.sync.apply(this,arguments)},add:function(t,e){return this.set(t,b.extend({merge:!1},e,_))},remove:function(t,e){e=b.extend({},e);var i=!b.isArray(t),t=(t=i?[t]:t.slice(),this._removeModels(t,e));return!e.silent&&t.length&&(e.changes={added:[],merged:[],removed:t},this.trigger("update",this,e)),i?t[0]:t},set:function(t,e){if(null!=t){(e=b.extend({},w,e)).parse&&!this._isModel(t)&&(t=this.parse(t,e)||[]);for(var i=!b.isArray(t),n=(t=i?[t]:t.slice(),e.at),s=((n=(n=null!=n?+n:n)>this.length?this.length:n)<0&&(n+=this.length+1),[]),r=[],o=[],h=[],a={},l=e.add,c=e.merge,u=e.remove,d=!1,f=this.comparator&&null==n&&!1!==e.sort,p=b.isString(this.comparator)?this.comparator:null,g=0;g<t.length;g++){var v,m=t[g],_=this.get(m);_?(c&&m!==_&&(v=this._isModel(m)?m.attributes:m,e.parse&&(v=_.parse(v,e)),_.set(v,e),o.push(_),f)&&!d&&(d=_.hasChanged(p)),a[_.cid]||(a[_.cid]=!0,s.push(_)),t[g]=_):l&&(m=t[g]=this._prepareModel(m,e))&&(r.push(m),this._addReference(m,e),a[m.cid]=!0,s.push(m))}if(u){for(g=0;g<this.length;g++)a[(m=this.models[g]).cid]||h.push(m);h.length&&this._removeModels(h,e)}var y=!1;if(s.length&&(!f&&l&&u)?(y=this.length!==s.length||b.some(this.models,function(t,e){return t!==s[e]}),this.models.length=0,x(this.models,s,0),this.length=this.models.length):r.length&&(f&&(d=!0),x(this.models,r,null==n?this.length:n),this.length=this.models.length),d&&this.sort({silent:!0}),!e.silent){for(g=0;g<r.length;g++)null!=n&&(e.index=n+g),(m=r[g]).trigger("add",m,this,e);(d||y)&&this.trigger("sort",this,e),(r.length||h.length||o.length)&&(e.changes={added:r,removed:h,merged:o},this.trigger("update",this,e))}return i?t[0]:t}},reset:function(t,e){e=e?b.clone(e):{};for(var i=0;i<this.models.length;i++)this._removeReference(this.models[i],e);return e.previousModels=this.models,this._reset(),t=this.add(t,b.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,b.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,b.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return l.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[this.modelId(this._isModel(t)?t.attributes:t,t.idAttribute)]||t.cid&&this._byId[t.cid]},has:function(t){return null!=this.get(t)},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t=t||{};var i=e.length;return b.isFunction(e)&&(e=e.bind(this)),1===i||b.isString(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return this.map(t+"")},fetch:function(i){var n=(i=b.extend({parse:!0},i)).success,s=this;return i.success=function(t){var e=i.reset?"reset":"set";s[e](t,i),n&&n.call(i.context,s,t,i),s.trigger("sync",s,t,i)},N(this,i),this.sync("read",this,i)},create:function(t,e){var n=(e=e?b.clone(e):{}).wait;if(!(t=this._prepareModel(t,e)))return!1;n||this.add(t,e);var s=this,r=e.success;return e.success=function(t,e,i){n&&(t.off("error",this._forwardPristineError,this),s.add(t,i)),r&&r.call(i.context,t,e,i)},n&&t.once("error",this._forwardPristineError,this),t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t,e){return t[e||this.model.prototype.idAttribute||"id"]},values:function(){return new E(this,S)},keys:function(){return new E(this,I)},entries:function(){return new E(this,k)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){return this._isModel(t)?(t.collection||(t.collection=this),t):(t=((e=e?b.clone(e):{}).collection=this).model.prototype?new this.model(t,e):this.model(t,e)).validationError?(this.trigger("invalid",this,t.validationError,e),!1):t},_removeModels:function(t,e){for(var i=[],n=0;n<t.length;n++){var s,r,o=this.get(t[n]);o&&(s=this.indexOf(o),this.models.splice(s,1),this.length--,delete this._byId[o.cid],null!=(r=this.modelId(o.attributes,o.idAttribute))&&delete this._byId[r],e.silent||(e.index=s,o.trigger("remove",o,this,e)),i.push(o),this._removeReference(o,e))}return 0<t.length&&!e.silent&&delete e.index,i},_isModel:function(t){return t instanceof v},_addReference:function(t,e){this._byId[t.cid]=t;var i=this.modelId(t.attributes,t.idAttribute);null!=i&&(this._byId[i]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var i=this.modelId(t.attributes,t.idAttribute);null!=i&&delete this._byId[i],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){if(e){if(("add"===t||"remove"===t)&&i!==this)return;var s,r;"destroy"===t&&this.remove(e,n),"changeId"===t&&(s=this.modelId(e.previousAttributes(),e.idAttribute),r=this.modelId(e.attributes,e.idAttribute),null!=s&&delete this._byId[s],null!=r)&&(this._byId[r]=e)}this.trigger.apply(this,arguments)},_forwardPristineError:function(t,e,i){this.has(t)||this._onModelEvent("error",t,e,i)}}),"function"==typeof Symbol&&Symbol.iterator),E=(y&&(m.prototype[y]=m.prototype.values),function(t,e){this._collection=t,this._kind=e,this._index=0}),S=1,I=2,k=3,y=(y&&(E.prototype[y]=function(){return this}),E.prototype.next=function(){if(this._collection){var t,e;if(this._index<this._collection.length)return t=this._collection.at(this._index),this._index++,{value:this._kind===S?t:(e=this._collection.modelId(t.attributes,t.idAttribute),this._kind===I?e:[e,t]),done:!1};this._collection=void 0}return{value:void 0,done:!0}},h.View=function(t){this.cid=b.uniqueId("view"),this.preinitialize.apply(this,arguments),b.extend(this,b.pick(t,P)),this._ensureElement(),this.initialize.apply(this,arguments)}),A=/^(\S+)\s*(.*)$/,P=["model","collection","el","id","attributes","className","tagName","events"],T=(b.extend(y.prototype,e,{tagName:"div",$:function(t){return this.$el.find(t)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof h.$?t:h.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t=t||b.result(this,"events"))for(var e in this.undelegateEvents(),t){var i=t[e];(i=b.isFunction(i)?i:this[i])&&(e=e.match(A),this.delegate(e[1],e[2],i.bind(this)))}return this},delegate:function(t,e,i){return this.$el.on(t+".delegateEvents"+this.cid,e,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,i){return this.$el.off(t+".delegateEvents"+this.cid,e,i),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){var t;this.el?this.setElement(b.result(this,"el")):(t=b.extend({},b.result(this,"attributes")),this.id&&(t.id=b.result(this,"id")),this.className&&(t.class=b.result(this,"className")),this.setElement(this._createElement(b.result(this,"tagName"))),this._setAttributes(t))},_setAttributes:function(t){this.$el.attr(t)}}),function(e,t){var i;return b.isFunction(e)?e:b.isObject(e)&&!t._isModel(e)?(i=b.matches(e),function(t){return i(t.attributes)}):b.isString(e)?function(t){return t.get(e)}:e}),H=(b.each([[m,{forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},"models"],[v,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes"]],function(t){var i=t[0],e=t[1],n=t[2];i.mixin=function(t){var e=b.reduce(b.functions(t),function(t,e){return t[e]=0,t},{});s(i,t,e,n)},s(i,b,e,n)}),h.sync=function(t,e,n){var i,s=H[t],r=(b.defaults(n=n||{},{emulateHTTP:h.emulateHTTP,emulateJSON:h.emulateJSON}),{type:s,dataType:"json"}),o=(n.url||(r.url=b.result(e,"url")||R()),null!=n.data||!e||"create"!==t&&"update"!==t&&"patch"!==t||(r.contentType="application/json",r.data=JSON.stringify(n.attrs||e.toJSON(n))),n.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),!n.emulateHTTP||"PUT"!==s&&"DELETE"!==s&&"PATCH"!==s||(r.type="POST",n.emulateJSON&&(r.data._method=s),i=n.beforeSend,n.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",s),i)return i.apply(this,arguments)}),"GET"===r.type||n.emulateJSON||(r.processData=!1),n.error),t=(n.error=function(t,e,i){n.textStatus=e,n.errorThrown=i,o&&o.call(n.context,t,e,i)},n.xhr=h.ajax(b.extend(r,n)));return e.trigger("request",e,t,n),t},{create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"}),$=(h.ajax=function(){return h.$.ajax.apply(h.$,arguments)},h.Router=function(t){t=t||{},this.preinitialize.apply(this,arguments),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)}),C=/\((.*?)\)/g,j=/(\(\?)?:\w+/g,O=/\*\w+/g,U=/[\-{}\[\]+?.,\\\^$|#\s]/g,M=(b.extend($.prototype,e,{preinitialize:function(){},initialize:function(){},route:function(e,i,n){b.isRegExp(e)||(e=this._routeToRegExp(e)),b.isFunction(i)&&(n=i,i=""),n=n||this[i];var s=this;return h.history.route(e,function(t){t=s._extractParameters(e,t);!1!==s.execute(n,t,i)&&(s.trigger.apply(s,["route:"+i].concat(t)),s.trigger("route",i,t),h.history.trigger("route",s,i,t))}),this},execute:function(t,e,i){t&&t.apply(this,e)},navigate:function(t,e){return h.history.navigate(t,e),this},_bindRoutes:function(){if(this.routes){this.routes=b.result(this,"routes");for(var t,e=b.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(U,"\\$&").replace(C,"(?:$1)?").replace(j,function(t,e){return e?t:"([^/?]+)"}).replace(O,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return b.map(i,function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null})}}),h.History=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)}),z=/^[#\/]|\s+$/g,q=/^\/+|\/+$/g,F=/#.*$/,R=(M.started=!1,b.extend(M.prototype,e,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){t=(t||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return(t=null==t?this._usePushState||!this._wantsHashChange?this.getPath():this.getHash():t).replace(z,"")},start:function(t){if(M.started)throw new Error("Backbone.history has already been started");if(M.started=!0,this.options=b.extend({root:"/"},this.options,t),this.root=this.options.root,this._trailingSlash=this.options.trailingSlash,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||7<document.documentMode),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(q,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return t=this.root.slice(0,-1)||"/",this.location.replace(t+"#"+this.getPath()),!0;this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}this._hasHashChange||!this._wantsHashChange||this._usePushState||(this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1,(t=(t=document.body).insertBefore(this.iframe,t.firstChild).contentWindow).document.open(),t.document.close(),t.location.hash="#"+this.fragment);t=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?t("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),M.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if((e=e===this.fragment&&this.iframe?this.getHash(this.iframe.contentWindow):e)===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),b.some(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0}))},navigate:function(t,e){if(!M.started)return!1;e&&!0!==e||(e={trigger:!!e}),t=this.getFragment(t||"");var i=this.root,i=(i=this._trailingSlash||""!==t&&"?"!==t.charAt(0)?i:i.slice(0,-1)||"/")+t,n=(t=t.replace(F,""),this.decodeFragment(t));if(this.fragment!==n){if(this.fragment=n,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)&&(n=this.iframe.contentWindow,e.replace||(n.document.open(),n.document.close()),this._updateHash(n.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){i?(i=t.href.replace(/(javascript:|#).*$/,""),t.replace(i+"#"+e)):t.hash="#"+e}}),h.history=new M,v.extend=m.extend=$.extend=y.extend=M.extend=function(t,e){var i=this,n=t&&b.has(t,"constructor")?t.constructor:function(){return i.apply(this,arguments)};return b.extend(n,i,e),n.prototype=b.create(i.prototype,t),(n.prototype.constructor=n).__super__=i.prototype,n},function(){throw new Error('A "url" property or function must be specified')}),N=function(e,i){var n=i.error;i.error=function(t){n&&n.call(i.context,e,t,i),e.trigger("error",e,t,i)}};return h});;
(()=>{var e,t={6373:e=>{e.exports=Backbone.Collection.extend({model:ThriveQuizB.models.Question})}},i={};function s(e){var n=i[e];if(void 0!==n)return n.exports;var o=i[e]={exports:{}};return t[e](o,o.exports,s),o.exports}window.ThriveQuizB=window.ThriveQuizB||{},ThriveQuizB.views=ThriveQuizB.views||{},ThriveQuizB.flows=ThriveQuizB.flows||{},e=jQuery,"ontouchstart"in document.documentElement||(document.documentElement.className+=" no-touch"),ThriveQuizB.loadedShortcodes=[],ThriveQuizB.templateSettings={evaluate:/<#([\s\S]+?)#>/g,interpolate:/<#=([\s\S]+?)#>/g,escape:/<#-([\s\S]+?)#>/g},ThriveQuizB.ajaxurl=function(e){var t=-1!==TQB_Front.ajax_url.indexOf("?")?"&":"?";return e&&e.length?(e=e.replace(/^(\?|&)/,""),e+="&_nonce="+TQB_Front.nonce,e+="&tqb-post-id="+TQB_Front.post_id,TQB_Front.ajax_url+t+e):TQB_Front.ajax_url+t+"_nonce="+ThriveQuizB.admin_nonce},ThriveQuizB.tpl=function(t,i){var s=e("script#"+t.replace(/\//g,"-")).html()||"";return s=s.replace(/(\n|\t|\r)/g,""),i?_.template(s,ThriveQuizB.templateSettings)(i):_.template(s,ThriveQuizB.templateSettings)},ThriveQuizB.getQueryParams=function(){var e=window.location.search||"",t={};if(e=e.substr(1),window.tqb_restart_quiz&&(t.restart_quiz=1),!e.length)return t;var i=e.split("&");return _.each(i,(function(e){var i=e.split("=")[0];i&&(t[i]=decodeURIComponent(e.split("=")[1]))})),t},e.fn.tqb=function(t,i){if(t||(t={}),i=i||!1,window.TQB_Front=window.TQB_Front||window.TQB_Front_Ajax||null,window.TQB_Front){if(e.each(t,(function(e,i){-1!==ThriveQuizB.loadedShortcodes.indexOf(e)&&delete t[e],ThriveQuizB.loadedShortcodes.push(e)})),0===Object.keys(t).length)return!1;!0!==i?window.TVE_Dash&&!TVE_Dash.ajax_sent?e(document).on("tve-dash.load",(function(e){o()})):o():ThriveGlobal.$j.ajax({url:TQB_Front.ajax_url,type:"get",data:_.extend(n(),{route:"get_quiz_data"})}).done(s)}function s(e,t){void 0!==t&&t.lazy_load_conditional_preview&&tcb_condition_sets&&(tcb_condition_sets=tcb_condition_sets.concat(t.lazy_load_conditional_preview));var i=new ThriveQuizB.collections.Shortcodes;Object.keys(e).forEach((function(t){TQB_Front.quiz_options[e[t].quiz_id]={feedback_settings:e[t].feedback_settings,highlight_settings:e[t].highlight_settings,progress_settings:e[t].progress_settings,scroll_settings:e[t].scroll_settings,quiz_style:e[t].quiz_style},e[t].id=t;var s=new ThriveQuizB.models.Shortcode(e[t]);i.add([s])})),ThriveQuizB.shortcode_list&&ThriveQuizB.shortcode_list.destroy(),ThriveQuizB.shortcode_list=new ThriveQuizB.views.ShortcodeList({collection:i}),ThriveQuizB.shortcode_list.render()}function n(){return _.extend({},{quiz_ids:t,tqb_scripts_loaded:!0},ThriveQuizB.getQueryParams())}function o(){window.TVE_Dash&&TVE_Dash.add_load_item("tqb_lazy_load",n(),s)}},e((function(){var t=e(this);ThriveGlobal.$j(window).on("conditional_display_loaded",(function(){ThriveQuizB.shortcode_list&&ThriveQuizB.shortcode_list.render()})),ThriveGlobal.$j(document).on("tqb_quiz_loaded",(function(i,s){var n={};_.each([s.quiz_id],(function(t){var i=e("[data-quiz-id="+t+"]"),s=i.attr("data-unique");n[s]=i.attr("data-quiz-id")})),t.tqb(n,!0)}));var i={};e(".tqb-shortcode-wrapper").each((function(){i[this.getAttribute("data-unique")]=this.getAttribute("data-quiz-id")})),t.tqb(i)})),window.ThriveQuizB=window.ThriveQuizB||{},ThriveQuizB.models=ThriveQuizB.models||{},ThriveQuizB.collections=ThriveQuizB.collections||{},function(e){e((function(){ThriveQuizB.models.Base=Backbone.Model.extend({idAttribute:"ID",validation_error:function(e,t){return{field:e,message:t}},custom_action:function(e,t,i){t||(t={});var s=_.extend({type:"post",dataType:"json",url:this.url()+"&custom_action="+i,data:t},e);return jQuery.ajax(s)}}),ThriveQuizB.collections.Base=Backbone.Collection.extend({last:function(){return this.at(this.size()-1)}}),ThriveQuizB.models.Shortcode=ThriveQuizB.models.Base.extend({idAttribute:"id",defaults:{id:null,quiz_id:null,user_unique:null,page_type:"",page:{page_id:null,variation_id:null,html:"",css:"",fonts:""},question:null,chosenAnswers:{},userAnswers:{}},parse:function(t){return e(TCB_Front).trigger("tqb_shortcode_response",t),t},url:function(){return ThriveQuizB.ajaxurl("&route=shortcode")},logSocialShareConversion:function(e,t){this.custom_action(e,t,"log_social_share_conversion")},saveUserCustomSocialShareBadge:function(e,t){this.custom_action(e,t,"save_user_custom_social_share_badge")},initialize:function(e){this.set("results_settings",new ThriveQuizB.models.ResultsSettings(e.results_settings||{}))},has_optin_page:function(){return this.get("structure")&&this.get("structure").optin},tpl:function(t){var i=this.get("tve_qna_templates");return(i=(i=i&&i[this.get("quiz_style")])&&i[t])?(i=e("<textarea/>").html(i).text(),_.template(i,ThriveQuizB.templateSettings)):null},hasQnaTpl:function(){var e=this.get("tve_qna_templates");return(e=e&&e[this.get("quiz_style")])&&Object.keys(e).length>0},getSharedStyles:function(){var e="";return this.get("tve_shared_styles")&&(e=this.get("tve_shared_styles")[this.get("page_type")]),e},shouldDisplayFeedbackUntilNext:function(){var e="right_wrong"===this.get("quiz_type")&&this.get("highlight_settings").load_next_question;return this.get("feedback_settings")&&1===this.get("feedback_settings").press_next&&!e},shouldDisplayFeedbackUntilTime:function(){var e="right_wrong"===this.get("quiz_type")&&this.get("highlight_settings").load_next_question;return!("survey"===this.get("quiz_type"))&&this.get("feedback_settings")&&1===this.get("feedback_settings").display_feedback&&!e},shouldShowNavButtons:function(){return!0===this.get("feedback_settings").nav_buttons},shouldDisplayProgress:function(){return this.get("progress_settings")&&1===this.get("progress_settings").display_progress},handleBranchSwitched:function(e,t){var i=this;if(!e.isOpenEndedType()&&!e.allowMultipleAnswers()){var s=this.get("userAnswers");if(parseInt(s[e.get("id")])!==t&&!e.get("next_question_id")){var n=parseInt(s[e.get("id")]),o=e.get("answers").find((function(e){return e.id===n.toString()})),r=e.get("answers").find((function(e){return e.id===t.toString()}));o&&o.next_question_id&&o.next_question_id!==r.next_question_id&&function(){s[e.get("id")]=t;for(var n,r,a=i.get("all_questions").find((function(e){return e.id===o.next_question_id}));a&&s[a.id];)n=s[a.id],r=a.next_question_id?a.next_question_id:a.answers.find((function(e){return e.id===n})).next_question_id,delete s[a.id],a=i.get("all_questions").find((function(e){return e.id===r}))}()}}},getShowFeedbackTime:function(){return 1e3*parseInt(this.get("feedback_settings").display_feedback_time)}}),ThriveQuizB.models.ResultsSettings=ThriveQuizB.models.Base.extend({initialize:function(e){this.set("message",new Backbone.Model(e.message)),e.links&&this.set("links",new Backbone.Collection(e.links))},get_type:function(){return this.get("type")},isURL:function(){return"url"===this.get_type()},get_redirect_url:function(t,i){var s="",n={tqb_email:(i=i||{}).email||"",tqb_name:_.escape(i.name)||"",tqb_quiz_result:"personality"===t.quiz_type||"percentage"===t.quiz_type?t.explicit:t.user_points};t=_.extend({result_id:null,user_points:0,min_points:0,max_points:0},t||{});var o=parseInt(t.user_points);if(t.result_id){var r=this.get("links").findWhere({result_id:t.result_id});s=r.get("link")}else if("percentage"===this.get("quiz_type")){var a;a=t.min_points===t.max_points?100:100*(o-parseInt(t.min_points))/(parseInt(t.max_points)-parseInt(t.min_points)),this.get("links").each((function(e){a>=parseInt(e.get("lower_bound"))&&a<=parseInt(e.get("upper_bound"))&&(s=e.get("link"))}))}else this.get("links").each((function(e){o>=parseInt(e.get("lower_bound"))&&o<=parseInt(e.get("upper_bound"))&&(s=e.get("link"))}));return s.length&&this.get("forward_results")&&(s+="?"+e.param(n)),s}}),ThriveQuizB.models.Image=ThriveQuizB.models.Base.extend({defaults:_.extend({},ThriveQuizB.models.Base.prototype.defaults,{sizes:{thumbnail:{url:null}}}),initialize:function(e){"string"==typeof e&&this.set(_.extend({},this.defaults,{sizes:{full:{url:e},thumbnail:{url:e}},url:e}))},get_thumb:function(){return this.attributes.sizes.thumbnail?this.attributes.sizes.thumbnail.url||this.get("url")||null:this.get("url")||null}}),ThriveQuizB.models.Media=ThriveQuizB.models.Base.extend({defaults:_.extend({},ThriveQuizB.models.Base.prototype.defaults,{display_type:0,type:"",source:"",url:"",color:"",style:"",options:[]})}),ThriveQuizB.models.Video=ThriveQuizB.models.Media.extend({defaults:_.extend({},ThriveQuizB.models.Media.prototype.defaults,{video_id:"",style:{},thumb:"",source:"youtube",url:""}),initialize:function(e){this.get("thumb")&&this.set("thumb",new ThriveQuizB.models.Image(this.get("thumb"))),e.url&&0!==e.url.length||this.setDefaults(),this.buildEmbedCode()},setDefaults:function(){this.attributes.source="youtube"},buildEmbedCode:function(){if(this.attributes.url){var e=this.videoIdAndParams(),t=this.videoLibraryId();e&&this.set("video_id",e),t&&this.set("library_id",t)}},videoIdAndParams:function(){var e="";switch(this.attributes.source){case"youtube":var t=this.attributes.url.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/);e=t&&11==t[7].length?t[7]:"";break;case"vimeo":case"wistia":case"bunnynet":e=this.attributes.url.substring(this.attributes.url.lastIndexOf("/")+1)}return this.buildVideoParams(e)},videoLibraryId:function(){var e="";if(this.attributes.source){var t=this.attributes.url.split("/");e=t[t.length-2]}return e},buildVideoParams:function(e){var t=void 0!==this.attributes.options?this.attributes.options:[],i=void 0!==this.attributes.players?this.attributes.players:[],s=this.attributes.source,n=this.attributes.color?this.attributes.color.replace("#",""):"ffffff",o=[];if("vimeo"===s&&o.push("color="+this.attributes.color.replace("#","")),"wistia"===s&&(o.push("chromeless=false"),o.push("controlsVisibleOnLoad=true"),o.push("playerColor="+n)),"youtube"===s){var r=t&&1===parseInt(t.hide_logo.value)?1:0;o.push("modestbranding="+r)}return _.each(i[s],(function(e,i){var n=i,r=e,a=void 0!==t[n]?t[n].value:"0";switch(i){case"autoplay":if(["youtube","wistia","vimeo","bunnynet"].includes(s)&&"true"==(a=1===parseInt(a)?"true":"false"))switch(s){case"youtube":o.push("mute=1");break;case"vimeo":case"wistia":o.push("muted=1")}break;case"hide_logo":case"hide_controls":a=1===parseInt(a)?0:1;break;case"hide_full_screens":a=1===parseInt(a)?0:1,"wistia"===s&&(a=1===parseInt(a)?"true":"false");break;case"disable_playbar":a=1===parseInt(a)?0:1,"wistia"!==s&&"vimeo"!==s||(a=1===parseInt(a)?"true":"false");break;case"muted":case"loop":"bunnynet"===s&&(a=0===parseInt(a)?"false":"true");break;case"preload":"bunnynet"===s&&(a=1===parseInt(a)?"true":"false")}"youtube"===s&&"hide_logo"===i||"bunnynet"===s&&"preload"===i&&"false"===a&&t.autoplay||o.push(r+"="+a)})),"wistia"===s&&o.push("videoFoam=true"),o.length>1?e+="?"+o.join("&"):e}}),ThriveQuizB.models.Audio=ThriveQuizB.models.Video.extend({buildEmbedCode:function(){if(this.attributes.url){var e=this.videoIdAndParams();e&&this.set("video_id",e)}},videoIdAndParams:function(){return this.buildVideoParams("")},buildVideoParams:function(e){var t=void 0!==this.attributes.options?this.attributes.options:[],i=void 0!==this.attributes.players?this.attributes.players:[],s=this.attributes.audio_source,n=[];return"spotify"===s&&(e=this.attributes.url.replace("https://open.spotify.com","")),_.each(i[s],(function(e,i){var o=i,r=e,a=void 0!==t[o]?t[o].value:"0";switch(i){case"show_user":case"show_artwork":"soundcloud"===s&&(a=1===parseInt(a)?"false":"true");break;default:a=1===parseInt(a)?"true":"false"}n.push(r+"="+a)})),n.length>1?e+=n.join("&"):e}}),ThriveQuizB.models.Question=ThriveQuizB.models.Base.extend({idAttribute:"id",defaults:{id:null,question_id:null,type:null,text:"",image:"",description:""},initialize:function(e){this.set("settings",new ThriveQuizB.models.QuestionSettings(e.settings)),null!==e.display_settings&&("video"===e.display_settings.type?this.set("display_settings",new ThriveQuizB.models.Video(e.display_settings)):this.set("display_settings",new ThriveQuizB.models.Audio(e.display_settings)))},get_image:function(){return"string"==typeof this.get("image")?this.get("image"):this.get("image").sizes.full.url},isTypeOf:function(e){var t=!1;return["button","image","open"].indexOf(e)>=0&&("button"===e&&1===parseInt(this.get("q_type"))||"image"===e&&2===parseInt(this.get("q_type"))||"open"===e&&3===parseInt(this.get("q_type")))&&(t=!0),t},isOpenEndedType:function(){return this.isTypeOf("open")},showFeedback:function(){return!0===this.get("settings").get("display_question_feedback")},getAllowedAnswers:function(){var e=this.get("settings").get("allowed_answers");return e||(e=1),parseInt(e)},allowMultipleAnswers:function(){return this.getAllowedAnswers()>1},isLastQuestion:function(){return!(this.get("next_question_id")||this.get("answers")[0].next_question_id)}}),ThriveQuizB.models.FeedbackSettings=ThriveQuizB.models.Base.extend({defaults:{display_feedback:1,display_feedback_time:2,press_next:0,nav_buttons:!1},getFeedbackTime:function(){return parseInt(this.get("display_feedback_time"))},showFeedback:function(){return 1===this.get("display_feedback")||1===this.get("press_next")},showNextButton:function(){return 1===this.get("press_next")}}),ThriveQuizB.models.HilightSettings=ThriveQuizB.models.Base.extend({defaults:{highlight_answer:1,load_next_question:0,highlight_and_show_feedback:0},highlight:function(){return 0===this.get("load_next_question")},showFeedback:function(){return 1===this.get("highlight_and_show_feedback")},loadNext:function(){return 1===this.get("load_next_question")}}),ThriveQuizB.models.Answer=ThriveQuizB.models.Base.extend({idAttribute:"id",defaults:{id:null,order:null,text:"",image:""},initialize:function(){var e=TQB_Front.quiz_options[this.get("quiz_id")];e.feedback_settings.quiz_type=this.get("quiz_type"),e.highlight_settings.quiz_type=this.get("quiz_type"),this.set("highlight_settings",new ThriveQuizB.models.HilightSettings(e.highlight_settings)),this.set("feedback_settings",new ThriveQuizB.models.FeedbackSettings(e.feedback_settings))},highlight:function(){return this.get("highlight_settings")},feedback:function(){return this.get("feedback_settings")},isRightWrong:function(){return"right_wrong"===this.get("quiz_type")},hasFeedback:function(){return this.get("feedback")&&this.get("feedback").length>0},showFeedback:function(){return!!this.hasFeedback()&&(this.isRightWrong()?this.highlight().showFeedback():this.feedback().showFeedback())},showNextButton:function(){return this.isRightWrong()?this.highlight().loadNext():this.feedback().showNextButton()&&this.hasFeedback()},highlightAnswer:function(){return this.isRightWrong()&&(1===this.highlight().get("highlight_answer")||1===this.highlight().get("highlight_and_show_feedback"))},getShowFeedbackTime:function(){return 1e3*this.feedback().getFeedbackTime()},getDelayFeedbackTime:function(){return 1===parseInt(this.get("is_right"))?0:this.isRightWrong()?2e3:0},getTimeBeforeNextQuestion:function(){return this.showFeedback()||this.highlightAnswer()?this.getShowFeedbackTime():0},get_image:function(){return"string"==typeof this.get("image")?this.get("image"):this.get("image").sizes.full.url},validate:function(e,t){var i=[];if(!0===t.get("required")){var s=this.get("answer_text");if(!(s=e||s)||s.length<t.get_min_value())return[t.min_error()]}if(i.length)return i}}),ThriveQuizB.models.QuestionSettings=Backbone.Model.extend({get_max_value:function(){return parseInt(this.get("answer_limits").max.value)},get_min_value:function(){return parseInt(this.get("answer_limits").min.value)},min_error:function(){return this.get("answer_limits").min.error_message.replace("(limit)",this.get_min_value())},max_error:function(){return this.get("answer_limits").max.error_message.replace("(limit)",this.get_max_value())}}),ThriveQuizB.collections.Shortcodes=ThriveQuizB.collections.Base.extend({model:ThriveQuizB.models.Shortcode}),ThriveQuizB.collections.Answers=ThriveQuizB.collections.Base.extend({model:ThriveQuizB.models.Answer}),ThriveQuizB.models.ProgressSettings=ThriveQuizB.models.Base.extend({defaults:function(){return{quiz_id:"",display_progress:0}},getPercentToDisplay:function(){return"percentage_completed"===this.get("percent_type")?this.get("percentage"):100-this.get("percentage")}}),ThriveQuizB.models.ScrollSetting=ThriveQuizB.models.Base.extend({defaults:function(){return{enable_scroll:0}}})}))}(jQuery),(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}window.ThriveQuizB=window.ThriveQuizB||{},ThriveQuizB.views=ThriveQuizB.views||{};var t=function(e){return{initQuizFlows:function(){return e.each((function(e){var t=this;e.on("tqb.count",(function(e){Object.keys(e).forEach((function(i){Object.keys(e[i].flows.items).length&&(e[i].count=t._getHighestCount(e[i])+1)}))}))}),this),_.extend({first_question:this.getFirstQuestion().get("text")},{flows:{items:this.setQuestionFlows(this.getFirstQuestion())}})},_getHighestCount:function(e){var t=1;return Object.keys(e.flows.items).forEach((function(i){e.flows.items[i].count>t&&(t=e.flows.items[i].count)})),t},_setQuestionFlow:function(e){var t={};return null!==e.get("next_question_id")&&(t=this.setQuestionFlows(this.getQuestion(e.get("next_question_id")))),t},setQuestionFlows:function(e){if(void 0===e)return{};var t={},i="q_"+e.get("id");return t[i]={question:e.get("text"),count:1,flows:{items:this._setQuestionFlow(e)}},e.get("answers").each((function(e){var i=this.setAnswerFlows(e);t["a_"+e.get("id")]={answer:e.get("text"),flows:i,count:1}}),this),e.trigger("tqb.count",t),t},setAnswerFlows:function(e){var t={items:{}};return null!==e.get("next_question_id")&&0!==parseInt(e.get("next_question_id"))&&(t=_.extend({items:this.setQuestionFlows(this.getQuestion(e.get("next_question_id")))},{count:1,next_question_id:e.get("next_question_id")})),t},calculateFlows:function(){var e="quiz_"+this.getQuizId();ThriveQuizB.flows[e]=_.extend({flowsSet:!1},this.initQuizFlows()),ThriveQuizB.flows[e].flowsSet=!0},getFirstQuestion:function(){return e.findWhere({start:"1"})},getQuestion:function(t){return e.findWhere({id:t})},getQuizId:function(){return parseInt(this.getFirstQuestion().get("quiz_id"))}}},i=function(e,t){t=t||1e3,e.parents(".tve-leads-lightbox")&&setTimeout((function(){ThriveGlobal.$j(window).trigger("resize")}),t)};window.addEventListener("scroll",(function(){window.tqbLastScrollTime=(new Date).getTime()})),function(n){n((function(){ThriveQuizB.views.Base=Backbone.View.extend({render:function(){return this}}),ThriveQuizB.views.ShortcodeList=ThriveQuizB.views.Base.extend({events:{},el:n("body"),children:[],render:function(){return this.collection.each(this.renderOne,this),this},renderOne:function(e){if(e.get("page").html||e.get("question")){var t=this.$el.find("#tqb-shortcode-wrapper-".concat(e.get("quiz_id"),"-").concat(e.get("id").replace(".","\\.")));t.length||(t=this.$el.find('[id^="tqb-shortcode-wrapper-'.concat(e.get("quiz_id"),'"]')));var i=new ThriveQuizB.views.Shortcode({model:e,collection:this.collection,questions:e.get("all_questions"),el:t});i.render(),this.children.push(i),t.data("tcbQuiz",i)}e.get("error")&&TQB_Front.is_preview&&this.$el.find("#tqb-shortcode-wrapper-"+e.get("quiz_id")+"-"+e.get("id")).find(".tqb-frontend-error-message").html(e.get("error"))},destroy:function(){this.undelegateEvents(),_.each(this.children,(function(e){e.undelegateEvents()}))}}),ThriveQuizB.views.Shortcode=ThriveQuizB.views.Base.extend({events:{"click .tqb-shortcode-new-content .tqb-shortcode-submit-action":"nextPage","click .tqb-shortcode-new-content .tve_evt_manager_listen":"runEvent","click .tqb-shortcode-new-content .tve-dynamic-link":"restartQuiz"},to_load:0,sec_delay:1,powered_by_tqb:ThriveQuizB.tpl("powered-by-thrive-themes"),questions:null,quiz_type:null,render_count:0,initialize:function(e){this.questions=new(s(6373))(e.questions),this.quiz_type=this.model.get("quiz_type"),this.percentage=0;var t=this.model.get("user_answers"),o=this.model.get("userAnswers");t&&(t.forEach((function(e){t.filter((function(t){return e.question_id===t.question_id&&e.id!==t.id})).length?o[e.question_id]?o[e.question_id].push(e.answer_id):o[e.question_id]=[e.answer_id]:o[e.question_id]=null===e.answer_text||void 0===e.answer_text?e.answer_id:e.answer_text})),this.model.set("chosenAnswers",o)),e.model.get("restarted")&&this.deleteCachedAnswers(),this.generateQuizFlows();var r="quiz_"+this.model.get("quiz_id");this.flows=ThriveQuizB.flows[r]?ThriveQuizB.flows[r].flows.items:{},this.listenTo(this.questions,"remove next-question",this.renderNextQuestion),this.listenTo(this.questions,"prev-question",this.renderPrevQuestion),this.model.get("resume_flow")&&Array.isArray(this.model.get("resume_flow"))&&this.model.get("resume_flow").forEach(function(e,t){if(0===t||this.model.get("resume_flow")[t].question_id!==this.model.get("resume_flow")[t-1].question_id){var i="q_"+e.question_id,s="a_"+e.answer_id,n={},o=1,r=this.questions.findWhere({id:e.question_id}).get("answers").find((function(t){return t.id===e.answer_id}));null!==r.next_question_id&&0!==parseInt(r.next_question_id)&&this.flows[s].count?(n=this.flows[s].flows.items,o=this.flows[s].count):(n=this.flows[i].flows.items,o=this.flows[i].count);var a=this.percentage+(100-this.percentage)/o;a=Math.round(a),this.percentage=a,this.flows=n}}.bind(this)),this.questions.on("tqb.set_progress",(function(e){var t,i,s="a_"+e.selectedAnswer.get("id"),n="q_"+this.questions.findWhere({id:e.selectedAnswer.get("question_id")}).get("id");if(this.model.shouldShowNavButtons()&&!this.flows[n]){var o=ThriveQuizB.flows[r]?ThriveQuizB.flows[r]:{},a=this.calculateCurrentFlow(o);t=this.flows.flows.items,i=this.flows.count,this.percentage=a>1?100/(i+a-1)*(a-1):0}else null!==e.selectedAnswer.get("next_question_id")&&0!==parseInt(e.selectedAnswer.get("next_question_id"))&&this.flows[s].count?(t=this.flows[s].flows.items,i=this.flows[s].count):(t=this.flows[n].flows.items,i=this.flows[n].count);var d=this.percentage+(100-this.percentage)/i;d=Math.round(d),e.percentage=this.percentage=d,this.flows=t}),this),ThriveGlobal.$j(".tve_p_lb_content").on("tve.lightbox-open",(function(){i(n(this).find(".tqb-shortcode-wrapper"),3e3)}))},render:function(){return this.showLoader(),this.loadScripts(),this.initListeners(this.model),this.hideLoader(),this.render_count>0&&this.scrollQuiz(),this.render_count++,"ontouchstart"in document.documentElement||this.$el.addClass("no-touch"),this},generateQuizFlows:function(){var i=TQB_Front.quiz_options[this.model.get("quiz_id")],s=i.progress_settings;if(s=(s="object"===e(s)&&i.progress_settings)&&1===parseInt(i.progress_settings.display_progress))try{new t(this.getDataForProgress()).calculateFlows()}catch(e){}},getDataForProgress:function(){var e=JSON.parse(JSON.stringify(this.questions));return(e=new Backbone.Collection(e)).each((function(e){e.set("answers",new Backbone.Collection(e.get("answers")))})),e},saveAnswers:function(e,t){var i=t.get("user_answer_ids");n.ajax({type:"post",url:ThriveQuizB.ajaxurl("&route=shortcode&custom_action=register_question_answer"),data:{user_unique:e.model.get("user_unique"),quiz_id:e.model.get("quiz_id"),answer_ids:i,answer_text:t.get("user_answer_model")?t.get("user_answer_model").get("answer_text"):""},success:function(t){if("boolean"!=typeof t){var i={};Object.values(t).forEach((function(e){i[e.question_id]=e.answer_id})),e.model.set("userAnswers",i)}}})},renderNextQuestion:function(e){var t=new Backbone.Collection(e.get("answers")),i=e.get("user_answer_ids"),s=e.allowMultipleAnswers()?e.get("user_answer_model"):t.findWhere({id:i[0]}),n=e.get("next_question_id")?e.get("next_question_id"):e.get("answers").find((function(e){return parseInt(e.id)===parseInt(i[0])})).next_question_id,o=this.questions.findWhere({id:n});o&&(o.set("previous_question_id",e.get("id")),this.model.set("navigatedBack",!1)),setTimeout((function(t){o?(t.renderQuestion(o),t.scrollQuiz(),e.set("answersEdited",!1),t.saveAnswers(t,e)):(s.set("answer_text",e.get("user_answer_model").get("answer_text")),t.shortcodeAction(s))}),this._get_delay(),this)},getPreviousQuestion:function(t){var i=this.model.get("chosenAnswers");if(t.get("previous_question_id")&&i[parseInt(t.get("previous_question_id"))])return this.questions.findWhere({id:t.get("previous_question_id")});var s=this.questions.filter((function(s){var n=i[parseInt(s.get("id"))];return!(!n&&""!==n||(s.get("next_question_id")?s.get("next_question_id")!==t.get("id"):!s.get("answers").filter((function(i){var s;return s="object"===e(n)?Object.values(n).indexOf(i.id)>-1:n===i.id,i.next_question_id===t.get("id")&&(s||t.isOpenEndedType())})).length))}));return s.length?s[0]:null},renderPrevQuestion:function(e){var t=this.getPreviousQuestion(e),i=new Backbone.Collection(e.get("answers")),s=e.allowMultipleAnswers()?e.get("user_answer_model"):i.findWhere({id:e.get("user_answer_ids")});t&&this.model.set("navigatedBack",!0),setTimeout((function(i){t?(i.renderQuestion(t),i.scrollQuiz(),e.get("answersEdited")&&i.saveAnswers(i,e)):(s.set("answer_text",e.get("user_answer_model").get("answer_text")),i.shortcodeAction(s))}),this._get_delay(),this)},loadScripts:function(){var e=this,t=this.model.get("page"),i=[],s=n("head"),o=this.$(".tqb-shortcode-new-content");if(t&&t.optimized_assets){if(t.optimized_assets.style){var r=document.createElement("style");document.head.prepend(r),r.setAttribute("data-tqb-variation",t.variation_id),r.appendChild(document.createTextNode(t.optimized_assets.style))}if(t.optimized_assets.files)for(var a in t.optimized_assets.files){var d="flat"===a;(!s.find('link[href*="thrive_flat.css"]').length&&d||!d)&&s.append(t.optimized_assets.files[a])}t.optimized_assets.js&&s.append(t.optimized_assets.js)}if(o.html("").append(this.model.getSharedStyles()),this.model.get("tve_custom_style")){var l=n("<style/>").addClass("tve_custom_style").html(this.model.get("tve_custom_style"));o.append(l)}t&&(i=(i=i.concat(t.css)).concat(t.fonts)),this.model.get("question")&&(i=i.concat(this.model.get("question").css)),this.to_load=i.length,_.each(i,(function(t,s,o){var r=n('<link rel="stylesheet" type="text/css" media="all" href="'+t+'">');e.$(".tqb-shortcode-new-content").append(r),r.on("load",(function(){e.to_load--,s===i.length-1&&e.check_loaded()}))}))},loadHTML:function(){if(1!=navigator.userAgent.toLowerCase().indexOf("firefox")>-1||!0!==(window.tqbLastScrollTime&&(new Date).getTime()<window.tqbLastScrollTime+100)||!this.$el.closest(".tve-scroll-sticky").length){if(_.isEmpty(this.model.get("page"))){this.template=ThriveQuizB.tpl("question-wrapper");var e=this.model.get("tve_qna_templates");if(e){var t=e[this.model.get("quiz_style")];t&&t.questionWrapper&&(this.template=_.template(t.questionWrapper,ThriveQuizB.templateSettings))}this.$el.find(".tqb-shortcode-new-content").append(this.template()),this.renderQuestion(),this.model.trigger("tqb:close_loader",this.model)}else{this.template=_.template(this.model.get("page").html,ThriveQuizB.templateSettings),this.$el.find(".tqb-shortcode-new-content").append(this.template(this.model.toJSON())),this.$el.find(".tqb-shortcode-new-content").append('<style type="text/css">'+this.model.get("page").user_css.replace(/\\/g,"")+"</style>"),this.setUserIdentifier(),this.listener(),TQB_Front.settings.tqb_promotion_badge&&this.$el.find(".tqb-shortcode-new-content .tve-tqb-page-type").after(this.powered_by_tqb()),"results"===this.model.get("page_type")?this.model.get("results_settings").isURL()?this.$el.find(".tqb-shortcode-new-content").html(this.redirectToResultHTML()):this.resultPageListener():this.model.trigger("tqb:close_loader",this.model);var i=this.model.get("page")&&this.model.get("page").quiz_user_result;"optin"!==this.model.get("page_type")&&"results"!==this.model.get("page_type")||void 0===i||this.$(".thrv_lead_generation form").append('<input type="hidden" name="tqb-quiz-user-result" value="'+i+'">')}setTimeout((function(e){e.hideLoader(),e.setOverlayHeight(),e.$el.offset().top,"splash"!==e.model.get("page_type")&&e.scrollQuiz()}),50,this),TCB_Front.onDOMReady(ThriveGlobal.$j(this.$el)),TCB_Front.handleIframes(ThriveGlobal.$j(this.$el),!0),ThriveGlobal.$j(TCB_Front).trigger("content_loaded.thrive",[this.$el.find(".tqb-shortcode-new-content")])}},check_loaded:function(){var e,t=this;if(this.to_load<=0)return this.loadHTML(),void clearTimeout(e);e=setTimeout((function(){t.check_loaded()}),50)},scrollQuiz:function(){var e,t=this.$el.parents(".thrive-quiz-builder-shortcode");if(t.length&&t.data("enable_scroll"))e="on"===t.data("enable_scroll");else{var i=TQB_Front.quiz_options[parseInt(this.model.get("quiz_id"))].scroll_settings,s=new ThriveQuizB.models.ScrollSetting(i);e=1===parseInt(s.get("enable_scroll"))}if(!0===e&&!this.$el.closest(".thrv-leads-slide-in").length)if(this.$el.parents(".tve_p_lb_background").length)n(".tve_p_lb_background").animate({scrollTop:0});else{var o=this;setTimeout((function(){var e=n(".thrv_header.tve-scroll-sticky").length?n(".thrv_header.tve-scroll-sticky").outerHeight():0;n("html,body").animate({scrollTop:o.$el.offset().top-e})}),500)}},runEvent:function(e){var t=n(e.currentTarget),i=t.attr("data-tcb-events");if("string"==typeof t.data("shortcode-id")&&t.data("shortcode-id").includes("next_step_in_quiz"))return e.preventDefault(),void this.shortcodeAction();if("string"==typeof i){var s=!1,o=ThriveGlobal.$j.parseJSON(i.replace("__TCB_EVENT_","").replace("_TNEVE_BCT__",""));t.is("a")&&t.closest(".tve_ea_thrive_quiz_next_step ").length&&e.preventDefault(),e.stopPropagation();for(var r=0,a=o.length;r<a;r++)if("thrive_quiz_next_step"===o[r].a)s=!0;else if("thrive_animation"===o[r].a){var d=t.is("a")?t:t.parent("a"),l=d.attr("href");l&&(d.attr("target")?window.open(l,"_blank"):window.location.href=l)}s&&(e.preventDefault(),this.shortcodeAction())}},deleteCachedAnswers:function(){this.model.set({chosenAnswers:{},userAnswers:{}})},forceRestartQuiz:function(){this.deleteCachedAnswers(),this.model.trigger("tqb:show_loader"),this.undelegateEvents();var e={},t=this.$el.data("unique");e[t]=this.$el.data("quiz-id"),Object.keys(ThriveQuizB.loadedShortcodes).forEach((function(t){"undefined"!==e[t]&&delete ThriveQuizB.loadedShortcodes[t]})),window.tqb_restart_quiz=1,n(this).tqb(e),delete window.tqb_restart_quiz},restartQuiz:function(e){"tqb_quiz_options"===this.$(e.currentTarget).data("dynamic-link")&&(e.preventDefault(),this.$(e.currentTarget).data("shortcode-id").includes("restart_quiz")?this.forceRestartQuiz():this.$(e.currentTarget).data("shortcode-id").includes("next_step_in_quiz")&&this.runEvent(e))},setUserIdentifier:function(){this.$el.find(".tqb-hidden-form-info.tqb-hidden-user-unique").val(this.model.get("user_unique"))},setOverlayHeight:function(){var e=this.$el.find(".tqb-shortcode-new-content").outerHeight();this.$el.find(".tqb-loading-overlay").css({height:e+"px"})},listener:function(){var e=this,t=this.$el.find(".tve_et_tve-viewport"),i=function(t){e.model.set("form_data",_.extend({email:"",name:""},t.form_data||{})),e.model.set({$leadGeneration:t.$leadGeneration,$form:t.$form}),e.nextPage()};ThriveGlobal.$j(this.$el).off("lead_conversion_error_code.tcb").on("lead_conversion_error_code.tcb",".thrv_lead_generation",(function(e){"no_connection"===e.errorCode&&i(e)})),ThriveGlobal.$j(this.$el).off("lead_conversion_success.tcb").on("lead_conversion_success.tcb",".thrv_lead_generation",(function(t){t.content_unlocked="results"!==e.model.get("page_type"),i(t)})),ThriveGlobal.$j(this.$el).off("should_submit_form.tcb").on("should_submit_form.tcb",".thrv_lead_generation",(function(e){return e.flag_need_data=!0,!0})),this.$el.find(".tqb-shortcode-new-content").addClass("ajax-content"),"function"==typeof window.tar_trigger_viewport&&"function"==typeof window.tar_trigger_exit_viewport&&(jQuery(window).scroll((function(){window.tar_trigger_viewport(t.filter(":not(.tve-viewport-triggered)")),window.tar_trigger_exit_viewport(t.filter(".tve-viewport-triggered"))})),setTimeout((function(){window.tar_trigger_viewport(t),e.$el.find(".tqb-shortcode-new-content").trigger("content-inserted.tcb").removeClass("ajax-content")}),200)),TCB_Front.onDOMReady(ThriveGlobal.$j(e.$el.find(".tqb-shortcode-new-content"))),TCB_Front.event_triggers(e.$el.find(".tqb-shortcode-new-content"))},switchContent:function(){var e=this.$el.find(".tqb-shortcode-old-content"),t=this.$el.find(".tqb-shortcode-new-content");e.html(t.html())},nextPage:function(){this.shortcodeAction()},shortcodeAction:function(e){if("results"!==this.model.get("page_type")){this.hideErrorToast();var t=this,s=e?this.getQuestionData(e):this.getPageData(),n=this.model.has_optin_page()&&void 0===e&&"optin"===s.page_type;s=_.extend({},s,ThriveQuizB.getQueryParams()),(n=n||!this.model.has_optin_page()&&void 0!==e&&"splash"===s.page_type)&&this.model.get("results_settings").isURL()&&this.model.get("results_settings").get("display_message")?this.model.trigger("tqb:show_redirect_loader",this.model):this.model.trigger("tqb:show_loader",this.model),s.form_data=this.model.get("form_data");var o=this.model.get("$leadGeneration");o&&o.length&&(s.form_data._tcb_id=o.attr("data-settings-id")),this.model.fetch({data:s,success:function(e){var s=!1;if(TCB_Front&&(s=TCB_Front.Hooks.applyFilters("tqb.stop_render_quiz_page",!1,e,t.$el)),!s){if("results"===e.get("page_type")&&e.get("results_settings").isURL()){var n=e.get("results_settings").get("message"),o=parseInt(n.get("duration"));o=isNaN(o)?0:o,o*=1e3,e.get("results_settings").get("display_message")||(o=0),setTimeout((function(e){t.redirectToResultURL(e)}),o,e)}else t.render();i(t.$el)}}})}},isSavingUserProgress:function(){var e=this.$el.attr("data-save-user-progress");return e&&1===Number(e)},redirectToResultHTML:function(){return new ThriveQuizB.views.ResultRedirect({view:this,model:new Backbone.Model({results_label:this.$el.attr("data-red-results-label"),retake_quiz:parseInt(this.$el.attr("data-red-retake-quiz")),retake_quiz_label:this.$el.attr("data-red-retake-quiz-label"),completed_quiz_label:this.$el.attr("data-red-quiz-completed-label")})}).render().$el},redirectToResultURL:function(e){var t=(e=e||this.model).get("results_settings").get_redirect_url(e.get("points"),e.get("form_data"));t.length&&(window.location=t)},hideErrorToast:function(){n("#tve-lg-error-container").hide()},getQuestionData:function(e){return{user_unique:this.model.get("user_unique"),quiz_id:this.model.get("quiz_id"),page_type:this.model.get("page_type"),answer_ids:Array.isArray(e.get("id"))?e.get("id"):[e.get("id")],answer_text:e.get("answer_text")||""}},getPageData:function(){var e=this.model.get("page");return{user_unique:this.model.get("user_unique"),quiz_id:this.model.get("quiz_id"),page_type:this.model.get("page_type"),variation:{page_id:e&&e.page_id||"",id:e&&e.variation_id||""}}},renderQuestion:function(e){e=void 0===e?this.questions.findWhere({start:"1"}):e,1===this.model.get("resume")&&this.model.get("question")&&(e=this.questions.findWhere({id:this.model.get("question").data.id}),this.model.set("resume",0)),_.each(e.get("answers"),(function(e){e.quiz_type=this.quiz_type}),this);var t=new ThriveQuizB.collections.Answers(e.get("answers"));new ThriveQuizB.views.Question({model:e,questions:this.questions,collection:t,quiz_type:this.quiz_type,flows:this.flows,percentage:this.percentage,shortcode:this.model,el:this.$el.find(".tqb-shortcode-new-content .tqb-question-wrapper")}).render()},resultPageListener:function(){var e=this;ThriveGlobal.$j(tve_frontend_options.is_editor_page?"#tve_editor":"body").on("click",".thrv_social_custom .tve_s_link",(function(){e.model.logSocialShareConversion({},{page_id:e.model.get("page").page_id,quiz_id:e.model.get("page").quiz_id,variation_id:e.model.get("page").variation_id,"tqb-variation-user_unique":e.model.get("user_unique")})}));var t=this.model.get("page").badge_url||null,i=e.model.get("page").has_social_badge&&1==e.model.get("page").has_social_badge&&e.model.get("page").html_canvas&&!t,s=n('<div id="tie-preloader-gif"></div>'),o=e.$(".tqb-social-share-badge-container"),r=o.find(".tve_s_fb_share"),a=o.find("img"),d=n('<div id="tie-html-canvas" style="overflow: visible; position: absolute; z-index: -1; visibility: hidden;">'+(e.model.get("page").html_canvas?e.model.get("page").html_canvas:"")+"</div>"),l=((new Date).getTime(),0);function h(){r.removeAttr("data-image"),a.removeAttr("src"),o.children().hide(),o.append(s),n("style[onLoad]").removeAttr("onLoad")}function u(t){l++,a.attr("src",t),2===l&&r.attr("data-image",t);var i=e.model.get("quiz_url"),s="",n=r.attr("data-description");"I got: "===n&&(n=""),s+="&tqb_redirect_post_id="+TQB_Front.post_id,s+="&image_url="+t,s+="&description="+encodeURIComponent(n),-1===i.indexOf("?")&&(s+="?"+s.substr(1)),i+=s,r.attr("data-href",i),ThriveGlobal.$j(tve_frontend_options.is_editor_page?"#tve_editor":"body").on("click",".tqb-social-share-badge-container .tve_s_link",(function(){e.model.logSocialShareConversion({},{page_id:e.model.get("page").page_id,quiz_id:e.model.get("page").quiz_id,variation_id:e.model.get("page").variation_id,"tqb-variation-user_unique":e.model.get("user_unique")});var t=ThriveGlobal.$j(this).parents(".tve_s_item"),i=t.attr("data-s");TCB_Front.onSocialCustomClick[i]&&TCB_Front.onSocialCustomClick[i](t)})),d.remove()}function c(e){u(e),a.load((function(){s.remove(),o.children().fadeIn(),(new Date).getTime()}))}ThriveGlobal.$j(document).trigger("tve_shortcode_content_loaded",this),t&&(h(),u(t)),i&&(e.$el.find(".tqb-shortcode-new-content").parents().each((function(e,t){n(t).addClass("tqb-overflow-visible-badge")})),n("body").append(d),h(),setTimeout((function(){html2canvas([d.get(0)],{logging:void 0!==ThriveQuizB.html2canvas,onrendered:function(t){var i=t.toDataURL("image/png");u(i),e.$el.find(".tqb-shortcode-new-content").parents().each((function(e,t){n(t).removeClass("tqb-overflow-visible-badge")}));var s=function(e){for(var t=atob(e.split(",")[1]),i=[],s=0;s<t.length;)i.push(t.charCodeAt(s)),s++;return new Blob([new Uint8Array(i)],{type:"image/jpg"})}(i),o=new FormData,r=e.model.get("quiz_id"),a=e.model.get("user_id"),d=e.model.get("page").result;o.append("user_badge",s,d+"-"+r+".png"),o.append("quiz_id",r),o.append("user_id",a),o.append("result",d),o.append("action","tqb_frontend_ajax_controller"),n.ajax({type:"post",url:ThriveQuizB.ajaxurl("&route=shortcode&custom_action=save_user_custom_social_share_badge"),data:o,processData:!1,contentType:!1,success:c})}})}),500))},showLoader:function(){this.$el.find(".tqb-loading-overlay").show(),this.$el.find(".tqb-shortcode-new-content").html("")},showRedirectLoader:function(){var e=this.$el.find(".tqb-loading-overlay"),t=ThriveQuizB.tpl("loaders/redirect");e.html(t({display_message:this.model.get("results_settings").get("display_message"),item:this.model.get("results_settings").get("message")})),e.show(),this.$el.find(".tqb-shortcode-new-content").html("")},hideLoader:function(){this.$(".tqb-loading-overlay").hide(),this.$el.css({"--tqb-placeholder-height-m":"","--tqb-placeholder-height-t":"","--tqb-placeholder-height-d":""})},initListeners:function(e){e.off("tqb:show_loader").on("tqb:show_loader",_.bind(this.showLoader,this)).off("tqb:show_redirect_loader").on("tqb:show_redirect_loader",_.bind(this.showRedirectLoader,this)),e.off("tqb:close_loader").on("tqb:close_loader",_.bind(this.hideLoader,this))},_get_delay:function(){var e=0;return"right_wrong"===this.quiz_type&&1===this.highlight_answer&&(e=1e3*this.sec_delay),e},calculateCurrentFlow:function(e){var t=this.model.get("userAnswers"),i=e.flows.items,s=Object.keys(i).filter((function(e){return e.startsWith("q")}));if(t[s=(s=s.length?s[0].match(/\d+/):"").length?s[0]:""]){var n;return n=this.model.get("all_questions").find((function(e){return e.id===s})).next_question_id?"q_"+s:"a_"+t[s],1+this.calculateCurrentFlow(i[n])}return this.flows=e,0}}),ThriveQuizB.views.VideoImageOverlay=Backbone.View.extend({template:ThriveQuizB.tpl("video/image-overlay"),events:{"click .tqb_video_overlay_image":"hideOverlayImage"},render:function(){var e=this.model.get("thumb")instanceof Backbone.Model&&this.model.get("thumb"),t=e?e.get("url"):"",i=this.model.get("source");return this.$el.find(".tqb-video-container-responsive").prepend(this.template({source:i,url:t})),this},hideOverlayImage:function(){this.$(".tqb_video_overlay_image").hide();var e,t=this.$el.find("iframe"),i=t.attr("src"),s=this.model.get("source");switch(s){case"youtube":i=(i=i.replace("&autoplay=0","")).replace("&autoplay=false","&autoplay=1"),e="&autoplay=true";break;case"vimeo":e="&autoplay=true";break;case"wistia":e="&autoPlay=true"}if(["youtube","vimeo","wistia","bunnynet"].includes(s))t=this.$el.find("iframe"),0!==i.length&&t.attr("src",i+e);else if((!TCB_Front.browser.safari||0===parseInt(data_controls)&&1===parseInt(data_overlay))&&("custom"===s||"self"===s)){var n=this.$el.find("video").get(0);n.paused?n.play():n.pause()}}}),ThriveQuizB.views.Media=Backbone.View.extend({renderVideoImageOverlay:function(){var e=this.model.get("thumb"),t=this.model.get("options");0==e instanceof Backbone.Model||void 0===t||void 0!==t.autoplay&&1===t.autoplay.value||new ThriveQuizB.views.VideoImageOverlay({model:this.model,el:this.$el}).render()},showLoader:function(){this.$el.find(".tqb-loading-overlay").show(),this.$el.find(".tqb-shortcode-new-content").html("")},hideLoader:function(){this.$el.find(".tqb-loading-overlay").hide()}}),ThriveQuizB.views.YotubeEmbededVideo=ThriveQuizB.views.Media.extend({template:ThriveQuizB.tpl("video/youtube"),render:function(){return this.showLoader(),this.$el.html(this.template({item:this.model})),this.renderVideoImageOverlay(),this.hideLoader(),this}}),ThriveQuizB.views.WistiaEmbededVideo=ThriveQuizB.views.Media.extend({template:ThriveQuizB.tpl("video/wistia"),render:function(){return this.showLoader(),this.$el.html(this.template({item:this.model})),this.renderVideoImageOverlay(),this.hideLoader(),this}}),ThriveQuizB.views.VimeoEmbededVideo=ThriveQuizB.views.Media.extend({template:ThriveQuizB.tpl("video/vimeo"),render:function(){return this.showLoader(),this.$el.html(this.template({item:this.model})),this.renderVideoImageOverlay(),this.hideLoader(),this}}),ThriveQuizB.views.CustomEmbededVideo=ThriveQuizB.views.Media.extend({template:ThriveQuizB.tpl("video/custom"),allowedMimeTypes:{asf:"video/x-ms-asf",asx:"video/x-ms-asf",wmv:"video/x-ms-wmv",wmx:"video/x-ms-wmx",wm:"video/x-ms-wm",avi:"video/avi",divx:"video/divx",flv:"video/x-flv",mov:"video/quicktime",qt:"video/quicktime",mpeg:"video/mpeg",mpg:"video/mpeg",mpe:"video/mpeg",mp4:"video/mp4",m4v:"video/mp4",ogv:"video/ogg",webm:"video/webm",mkv:"video/x-matroska"},render:function(){var e=this.media_mime();return this.$el.html(this.template({mime:e,item:this.model})),this.renderVideoImageOverlay(),this},media_mime:function(){var e=this.model.get("url").split(".").pop().toLowerCase();return"string"==typeof this.allowedMimeTypes[e]?this.allowedMimeTypes[e]:""}}),ThriveQuizB.views.BunnyNetEmbededVideo=ThriveQuizB.views.Media.extend({template:ThriveQuizB.tpl("video/bunny-net"),render:function(){return this.showLoader(),this.$el.html(this.template({item:this.model})),this.renderVideoImageOverlay(),this.hideLoader(),this}}),ThriveQuizB.views.CustomEmbededAudio=ThriveQuizB.views.CustomEmbededVideo.extend({allowedMimeTypes:{mp3:"audio/mpeg",mpeg:"audio/mpeg",m4a:"audio/m4a",m4b:"audio/mpeg",ra:"audio/x-realaudio",ram:"audio/x-realaudio",wav:"audio/wav",ogg:"audio/ogg",oga:"audio/ogg",mid:"audio/midi",midi:"audio/midi",wma:"audio/x-ms-wma",wax:"audio/x-ms-wax",mka:"audio/x-matroska"},template:ThriveQuizB.tpl("audio/custom")}),ThriveQuizB.views.SpotifyEmbededAudio=ThriveQuizB.views.CustomEmbededVideo.extend({template:ThriveQuizB.tpl("audio/spotify"),render:function(){var e="//open.spotify.com/embed"+this.model.get("video_id");return this.$el.html(this.template({item:this.model,src:e})),this}}),ThriveQuizB.views.SoundcloudEmbededAudio=ThriveQuizB.views.CustomEmbededVideo.extend({template:ThriveQuizB.tpl("audio/soundcloud")}),ThriveQuizB.views.Question=ThriveQuizB.views.Base.extend({template:ThriveQuizB.tpl("question"),powered_by_tqb:ThriveQuizB.tpl("powered-by-thrive-themes"),answersView:null,nextButtonClicked:!1,events:{"click .tqb-next-button, .tqb-finish-button":"nextClicked","click .tqb-check-button":"checkClicked","click .tqb-prev-button":"prevClicked"},initialize:function(e){this.questions=e.questions,this.quiz_type=e.quiz_type,this.flows=e.flows,this.percentage=e.percentage,this.shortcode=e.shortcode,this.allowedAnswers=this.model.getAllowedAnswers(),this.collection.on("tqb:disable_answer",_.bind(this.disableAllAnswers,this)).on("tqb:enable_answer",_.bind(this.enableAnswer,this)).on("tqb:show_nav_buttons",_.bind(this.showNavButtons,this)).on("tqb:enable_next",_.bind(this.enableNext,this)).on("tqb:disable_next",_.bind(this.disableNext,this)).on("tqb:show_right_answer",_.bind(this.showRightAnswer,this)).on("tqb:handle_progress",_.bind(this.handleProgress,this)).on("tqb:deselect_active_answers",_.bind(this.deselectActiveAnswers,this)).on("tqb:switch_next_with_check_button",_.bind(this.switchNextWithCheckButton,this))},deselectActiveAnswers:function(){var e=this.$(".tqb-active-answer");e.removeClass("tqb-active-answer").find(".tqb-answer-action").removeClass("tqe-selected-answer"),e.attr("data-clicked",0),e.find(".tqb-answer-feedback").addClass("tqb-hide")},showRightAnswer:function(e){_.each(this.collection.where({is_right:"1"}),(function(e){var t=this.$("#tqb-answer-"+e.get("id"));t.addClass("tqb-right tqb-right-answer tqb-rw"),t.attr("data-css",this.$("tqb-active-answer").attr("data-css"))}),this),"1"!==e.get("is_right")&&this.$("#tqb-answer-"+e.get("id")).addClass("tqb-wrong tqb-wrong-answer tqb-rw")},showNavButtons:function(){this.$(".tqb-button-holder").removeClass("tqb-hide").addClass("tqb-clear"),!this.model.isLastQuestion()||this.model.allowMultipleAnswers()&&this.shortcode.shouldDisplayFeedbackUntilNext()?!this.model.allowMultipleAnswers()||!this.shortcode.shouldDisplayFeedbackUntilNext()||this.shortcode.get("navigatedBack")||this.model.get("answersConfirmed")&&!this.model.isLastQuestion()?this.$(".tqb-next-button").removeClass("tqb-hide").addClass("tqb-clear"):this.$(".tqb-check-button").removeClass("tqb-disabled tqb-hide").addClass("tqb-clear"):this.$(".tqb-finish-button").removeClass("tqb-disabled tqb-hide").addClass("tqb-clear"),this.$(".tqb-prev-button").toggleClass("tqb-hide",1===parseInt(this.model.get("start"))||!this.shortcode.shouldShowNavButtons()),this.$("#tqb-thrv-label").css({position:"relative","z-index":"-1"})},prepareDataForNextQuestion:function(e){var t,i=this.model.isOpenEndedType()?this.$el.find("#tqb-open-type-answer").val():"";t=this.model.allowMultipleAnswers()?Array.from(e.map((function(e,t){return parseInt(t.getAttribute("data-id"))}))):e.length?[e[0].getAttribute("data-id")]:[this.collection.first().get("id")],this.model.set({user_answer_ids:t,user_answer_model:new Backbone.Model({answer_text:i,id:t})})},cacheUserAnswers:function(e){var t=this.shortcode.get("chosenAnswers"),i=this.model.isOpenEndedType()?this.$el.find("#tqb-open-type-answer").val():"";if(this.model.isOpenEndedType())t[this.model.get("id")]=i;else{var s=Array.from(e.map((function(e,t){return t.getAttribute("data-id")})));t[this.model.get("id")]&&!this.model.get("next_question_id")&&this.shortcode.handleBranchSwitched(this.model,s[0]),t[this.model.get("id")]=s}},feedbackWasDisplayed:function(e){var t=this;if(!e.length)return!1;var i=!1;return Array.from(e.map((function(e,t){return parseInt(t.getAttribute("data-id"))}))).forEach((function(e){var s=t.answersView.getAnswerView(e);s&&(i=i||s.displayFeedback())})),i},confirmAnswers:function(e){var t=this;e.length&&(Array.from(e.map((function(e,t){return parseInt(t.getAttribute("data-id"))}))).forEach((function(e){var i=t.answersView.getAnswerView(e);i&&(i.highlightAnswer(),i.handleFeedback())})),this.shortcode.shouldShowNavButtons()?this.disableAnswers():this.disableAllAnswers(),this.model.set("answersConfirmed",!0))},checkClicked:function(){var e=this.$(".tqb-active-answer");e.length&&(this.confirmAnswers(e),this.$(".tqb-prev-button").removeClass("tqb-disabled"),this.switchCheckWithNextButton())},validateOpenEndedAnswer:function(){if(this.model.isOpenEndedType()){var e=this.model.isOpenEndedType()?this.$el.find("#tqb-open-type-answer").val():"",t=this.collection.first(),i=t.validate(e,this.model.get("settings"));return!i||(t.trigger("invalid",t,[i]),!1)}return!0},handleDataForUpcomingQuestion:function(e){this.prepareDataForNextQuestion(e);var t=this.model.get("user_answer_ids");if(this.shortcode.shouldShowNavButtons()&&this.cacheUserAnswers(e),this.model.allowMultipleAnswers()||this.shortcode.shouldShowNavButtons()||this.model.isOpenEndedType()){var i=TQB_Front.quiz_options[this.model.get("quiz_id")];if(i.progress_settings&&1===i.progress_settings.display_progress){var s=t[0],n=1===this.collection.length?this.collection.first():this.collection.findWhere({id:s.toString()});this.handleProgress(n)}}this.disableAllAnswers(),this.disableNext(!0)},prevClicked:function(e){var t=this,i=this.$(".tqb-active-answer");!this.shortcode.shouldShowNavButtons()||this.model.get("answersEdited")&&!this.validateOpenEndedAnswer()||(this.model.get("answersEdited")&&this.handleDataForUpcomingQuestion(i),this.shortcode.shouldDisplayFeedbackUntilTime()&&this.shortcode.getShowFeedbackTime()&&!this.model.isOpenEndedType()&&this.model.get("answersEdited")?(this.disableNext(),this.confirmAnswers(i),this.$(".tqb-prev-button").addClass("tqb-disabled"),setTimeout((function(){t.questions.trigger("prev-question",t.model)}),this.shortcode.getShowFeedbackTime())):this.questions.trigger("prev-question",this.model),this.$el.off("click"))},nextClicked:function(e){var t=this,i=this.$(".tqb-active-answer");(i.length||this.model.isOpenEndedType())&&this.validateOpenEndedAnswer()&&(this.handleDataForUpcomingQuestion(i),this.$el.off("click"),this.shortcode.shouldDisplayFeedbackUntilTime()&&this.shortcode.getShowFeedbackTime()&&!this.model.isOpenEndedType()&&this.model.get("answersEdited")?(this.confirmAnswers(i),this.$(".tqb-prev-button").addClass("tqb-disabled"),setTimeout((function(){t.triggerGoToNextQuestion()}),this.shortcode.shouldDisplayFeedbackUntilTime()||this.feedbackWasDisplayed(i)?this.shortcode.getShowFeedbackTime():0)):this.triggerGoToNextQuestion())},triggerGoToNextQuestion:function(){var t=this.model.get("user_answer_ids");if(this.shortcode.shouldShowNavButtons())this.questions.trigger("next-question",this.model);else{if(!t)return;var i=this.collection.findWhere({id:t[0].toString()});"object"===e(i)&&i.trigger("tqb:choose_answer",i)}},enableNext:function(){this.$(".tqb-next-button, .tqb-check-button, .tqb-finish-button").removeClass("tqb-disabled")},disableNext:function(e){(this.shortcode.shouldShowNavButtons()&&0===this.$(".tqb-active-answer").length||e)&&this.$(".tqb-next-button, .tqb-check-button, .tqb-finish-button").addClass("tqb-disabled")},switchCheckWithNextButton:function(){this.model.isLastQuestion()?(this.$(".tqb-check-button").addClass("tqb-disabled tqb-hide").removeClass("tqb-clear"),this.$(".tqb-finish-button").removeClass("tqb-disabled tqb-hide").addClass("tqb-clear")):(this.$(".tqb-check-button").addClass("tqb-disabled tqb-hide").removeClass("tqb-clear"),this.$(".tqb-next-button").removeClass("tqb-disabled tqb-hide").addClass("tqb-clear"))},switchNextWithCheckButton:function(){this.shortcode.shouldDisplayFeedbackUntilNext()&&(this.model.isLastQuestion()?(this.$(".tqb-finish-button").addClass("tqb-disabled tqb-hide").removeClass("tqb-clear"),this.$(".tqb-check-button").removeClass("tqb-disabled tqb-hide").addClass("tqb-clear")):(this.$(".tqb-next-button").addClass("tqb-disabled tqb-hide").removeClass("tqb-clear"),this.$(".tqb-check-button").removeClass("tqb-disabled tqb-hide").addClass("tqb-clear")))},disableAllAnswers:function(){this.$(".tqb-answer-inner-wrapper").addClass("tqb-disable-answer")},disableAnswers:function(){this.shortcode.shouldShowNavButtons()&&this.$(".tqb-answer-inner-wrapper").not(".tqb-active-answer, .tqb-open-ended-wrapper").addClass("tqb-disable-answer")},enableAnswer:function(){this.$(".tqb-answer-inner-wrapper").removeClass("tqb-disable-answer")},handleProgress:function(e){this.selectedAnswer=e,this.questions.trigger("tqb.set_progress",this),this.renderProgress()},_qnaHtml:function(){if(this.shortcode.hasQnaTpl()){var e=this.model.get("display_settings")instanceof Backbone.Model&&this.model.get("display_settings"),t=e&&e.get("type")?e.get("type"):"";this.$el.html(jQuery(this.shortcode.tpl("questionWrapper")({item:this.model,display_type:t})).html()),this.$(".tqb-question-container").replaceWith(this.shortcode.tpl("questionContainer")({item:this.model,display_type:t})),this.$(".tqb-question-text").replaceWith(this.shortcode.tpl("questionText")({item:this.model})),this.$(".tqb-question-description").replaceWith(this.shortcode.tpl("questionDescription")({item:this.model})),"text"===t&&this.model.get("image")&&this.$(".tqb-question-container").append('<div class="tqb-question-image-container"><img src="'+this.model.get_image()+'" alt="question-image"></div>'),this.$(".tqb-answers-container").replaceWith(this.shortcode.tpl("answersContainer")())}},_html:function(){var e=this.model.get("display_settings")instanceof Backbone.Model&&this.model.get("display_settings"),t=e&&e.get("type")?e.get("type"):"";this.$el.html(this.template({item:this.model,shortcode:this.shortcode,display_type:t}))},render:function(){return this._html(),this._qnaHtml(),this.renderMedia(),this.renderProgress(),this.renderAnswers(),this.shortcode.shouldShowNavButtons()&&(this.showNavButtons(),this.model.set("answersEdited",!1),this.model.get("user_answer_ids")&&this.model.get("user_answer_ids").length>=this.model.getAllowedAnswers()&&this.model.allowMultipleAnswers()&&this.disableAnswers()),(this.allowedAnswers>1&&this.shortcode.shouldDisplayFeedbackUntilNext()||this.model.isOpenEndedType())&&this.showNavButtons(),this.shortcode.hasQnaTpl()&&this.renderNavButtons(),TQB_Front.settings.tqb_promotion_badge&&!this.$("#tqb-thrv-label").length&&(this.$el.append(this.powered_by_tqb()),this.$("#tqb-thrv-label").addClass("tqb-clear")),"1"!==this.model.get("start")&&this.model.isOpenEndedType()&&(this.$("#tqb-open-type-answer").focus(),this.collection.trigger("tqb:enable_next")),this.allowedAnswers>1&&!this.shortcode.get("chosenAnswers")[this.model.get("id")]&&(this.$(".tqb-next-button, .tqb-check-button").addClass("tqb-disabled"),this.shortcode.shouldDisplayFeedbackUntilNext()||(this.showNavButtons(),this.disableNext(!0))),i(this.$el),this},renderNavButtons:function(){this.model.isOpenEndedType()&&0!==this.$(".tqb-open-type-button").length&&this.$(".tqb-open-type-button").remove(),this.$(".tqb-button-holder").replaceWith(this.shortcode.tpl("nextQuestion")()),this.$(".tqb-open-ended-wrapper").removeClass("tqb-hide");var e=this.$(".tqb-button-holder");(this.shortcode.shouldDisplayFeedbackUntilNext()||this.model.isOpenEndedType()||this.model.allowMultipleAnswers()||this.shortcode.shouldShowNavButtons())&&e.removeClass("tqb-hide"),0===e.find(".tqb-prev-button").length&&(this.shortcode.shouldShowNavButtons()||this.shortcode.shouldDisplayFeedbackUntilNext())&&(e.prepend(ThriveQuizB.tpl("previous-button")()),e.append(ThriveQuizB.tpl("confirmation-buttons")())),0===this.$(".tqb-active-answer").length&&this.$(".tqb-next-button").addClass("tqb-disabled"),this.$(".tqb-prev-button").toggleClass("tqb-hide",1===parseInt(this.model.get("start"))||!this.shortcode.shouldShowNavButtons()),this.$(".tqb-next-button").toggleClass("tqb-hide",this.model.isLastQuestion()),this.model.isLastQuestion()&&(this.shortcode.shouldShowNavButtons()||this.shortcode.shouldDisplayFeedbackUntilNext())&&(this.$(".tqb-next-button").addClass("tqb-hide"),this.$(".tqb-finish-button").removeClass("tqb-hide")),this.model.isLastQuestion()&&this.model.isOpenEndedType()&&this.$(".tqb-finish-button").removeClass("tqb-hide");var t=e.find(".tqb-next-button").attr("data-css");this.$(".tqb-finish-button, .tqb-check-button").attr("data-css",t),this.allowedAnswers>1&&this.switchNextWithCheckButton()},renderMedia:function(){var e=this.model.get("display_settings");if(null!==e)switch(parseInt(e.get("display_type"))){case 0:default:this.renderText();break;case 1:this.renderVideo();break;case 2:this.renderAudio()}},renderText:function(){},renderAudio:function(){var e=e||this.$el.find(".tqb-question-media"),t=this.model.get("display_settings");switch(t.get("audio_source")){case"soundcloud":var i=new ThriveQuizB.views.SoundcloudEmbededAudio({model:t,el:e});break;case"spotify":i=new ThriveQuizB.views.SpotifyEmbededAudio({model:t,el:e});break;default:i=new ThriveQuizB.views.CustomEmbededAudio({model:t,el:e})}i.render()},renderVideo:function(e){e=e||this.$el.find(".tqb-question-media");var t=this.model.get("display_settings");switch(t.get("source")){case"youtube":var i=new ThriveQuizB.views.YotubeEmbededVideo({model:t,el:e});break;case"vimeo":i=new ThriveQuizB.views.VimeoEmbededVideo({model:t,el:e});break;case"wistia":default:i=new ThriveQuizB.views.WistiaEmbededVideo({model:t,el:e});break;case"custom":i=new ThriveQuizB.views.CustomEmbededVideo({model:t,el:e});break;case"bunnynet":i=new ThriveQuizB.views.BunnyNetEmbededVideo({model:t,el:e})}i.render()},renderProgress:function(){var e=TQB_Front.quiz_options[this.model.get("quiz_id")],t=new ThriveQuizB.models.ProgressSettings(e.progress_settings);1===parseInt(t.get("display_progress"))&&(t.set("percentage",this.percentage),this.$(".tqb-progress-container").remove(),"position_top"===e.progress_settings.progress_position?this.$el.prepend('<div class="tqb-progress-container tqb-hide"></div>'):this.$el.append('<div class="tqb-progress-container tqb-hide"></div>'),new ThriveQuizB.views.ProgressBar({template:this.shortcode.tpl("progressbarContainer"),shortcode:this.shortcode,model:t,flows:this.flows,hasSelectedAnswer:!!this.selectedAnswer,el:this.$(".tqb-progress-container"),quizId:this.model.get("quiz_id")}).render())},renderAnswers:function(){2===parseInt(this.model.get("q_type"))&&this.$el.find(".tqb-answers-container").addClass("tqb-answer-has-image"),this.answersView=new ThriveQuizB.views.Answers({model:this.model,collection:this.collection,questions:this.questions,quiz_type:this.quiz_type,shortcode:this.shortcode,el:this.$el.find(".tqb-answers-container")}),this.answersView.render()}}),ThriveQuizB.views.Answers=ThriveQuizB.views.Base.extend({events:{},views:{},initialize:function(e){this.questions=e.questions,this.quiz_type=e.quiz_type,this.shortcode=e.shortcode},render:function(){return this.$el.empty(),this.collection.each(this.renderOne,this),this},getAnswerView:function(e){return this.views[e]},renderOne:function(e){return e.on("tqb:choose_answer",(function(){var t=this.questions.findWhere({id:e.get("question_id")}),i=TQB_Front.quiz_options[this.model.get("quiz_id")];if(parseInt(e.get("next_question_id"))&&t.set({next_question_id:e.get("next_question_id")}),t.get("user_answer_ids")&&t.get("user_answer_ids").length||(t.set("user_answer_ids",[e.get("id")]),t.set("user_answer_model",e)),this.questions.remove(t),!0!==i.press_next&&"right_wrong"===this.quiz_type&&0===parseInt(e.get("is_right"))){var s=this.collection.findWhere({is_right:"1"});s instanceof ThriveQuizB.models.Answer&&s.trigger("tqb:indicate-right")}}),this),this.views[e.get("id")]=new ThriveQuizB.views.Answer({model:e,question:this.model,quiz_type:this.quiz_type,collection:this.collection,shortcode:this.shortcode}),this.$el.append(this.views[e.get("id")].render().$el),this}}),ThriveQuizB.views.Answer=ThriveQuizB.views.Base.extend({className:"tqb-answer-inner-wrapper",template:ThriveQuizB.tpl("answer"),template_image:ThriveQuizB.tpl("answer-image"),template_open:ThriveQuizB.tpl("answer-open"),events:{"click .tqb-answer-action":"answerAction","keyup textarea":function(e){var t=this.question.get("settings"),i=this.$(".tqb-answer-status"),s=t.get_max_value()-e.currentTarget.value.length;s<0?(e.currentTarget.value=e.currentTarget.value.substr(0,t.get_max_value()),this.model.trigger("invalid",this.model,[t.max_error()])):(i.html(TQB_Front.t.chars+": %s".replace("%s",s)),this.set_status("typing"),this.question.set("answersEdited",!0))}},right_class:"tqb-right-answer",wrong_class:"tqb-wrong-answer",quiz_type:null,$status:null,initialize:function(e){this.shortcode=e.shortcode,e.quiz_type&&(this.quiz_type=e.quiz_type),e.question&&e.question instanceof ThriveQuizB.models.Question&&(this.question=e.question),this.model.on("tqb:indicate-right",this.indicate_right,this),this.model.on("invalid",(function(e,t){this.set_status("error").html(t.shift())}),this)},indicate_right:function(){this.$el.addClass(this.right_class)},_tpl:function(e){var t=this.template,i=this.shortcode.tpl("answerItem");this.isQnaTpl=!1,this.question.isTypeOf("image")?(i=this.shortcode.tpl("answerImageItem"),t=this.template_image):this.question.isTypeOf("open")&&(i=this.shortcode.tpl("answerOpenItem"),t=this.template_open),i&&i.length&&(t=i,this.isQnaTpl=!0);var s=t(e);if(this.isQnaTpl){var o=n(s);this.$el.attr("data-css",o.data("css")),this.$el.addClass("tqb-editor-answer-wrapper"),o.find(".tqb-answer-icon").replaceWith(this.shortcode.tpl("answerIcon")()),o.find(".tcb-icon").removeClass("tcb-icon"),this.model.get("image")&&(o.find(".tqb-fancy-icon").addClass("tqb-fancy-rel"),o.find(".tqb-answer-image-container").html('<img src="'+this.model.get_image()+'" alt="" class="tqb-answer-image">')),s=o.find(".tqb-answer-content")[0].outerHTML}return s},_html:function(){var e=this._tpl({item:this.model,question:this.question,settings:this.question.get("settings")});this.isQnaTpl&&this.$el.attr("data-css",n(e).data("css")),this.$el.html(e)},render:function(){var e=this.shortcode.get("chosenAnswers"),t=this.question.get("id"),i=this.model.get("id");if(this._html(),this.question.isTypeOf("open")&&this.$el.addClass("tqb-open-ended-wrapper"),this.$status=this.$(".tqb-answer-status"),this.$el.attr("id","tqb-answer-"+this.model.get("id")),this.$el.attr("data-id",this.model.get("id")),e[t]||""===e[t]){var s=e[t].includes(i),n=this.question.isOpenEndedType()&&"string"==typeof e[t];s?(this.$el.find(".tqb-answer-action").addClass("tqe-selected-answer"),this.$el.addClass("tqb-active-answer"),this.highlightAnswer(),this.handleFeedback()):n&&this.$el.find("#tqb-open-type-answer").val(e[t]),this.collection.trigger("tqb:enable_next")}return this},answerAction:function(e){if(this.question.allowMultipleAnswers()){var t=this.$el.hasClass("tqb-active-answer"),i=this.$el.siblings(),s=this.$el.closest(".tqb-answers-container"),o=s.siblings(".tqb-button-holder"),r=o.find(".tqb-next-button"),a=o.find(".tqb-prev-button");return this.shortcode.shouldShowNavButtons()&&r.length&&this.shortcode.get("navigatedBack")&&(this.question.set("answersConfirmed",!1),this.shortcode.set("navigatedBack",!1),this.collection.trigger("tqb:switch_next_with_check_button")),t?(this.$el.removeClass("tqb-active-answer").find(".tqb-answer-action").removeClass("tqe-selected-answer"),i.removeClass("tqb-disable-answer"),s.find(".tqb-answer-feedback").not(".tqb-prev-button").addClass("tqb-hide"),this.question.set("answersConfirmed",!1),this.shortcode.shouldShowNavButtons()&&this.collection.trigger("tqb:switch_next_with_check_button"),0===s.find(".tqb-active-answer").length&&o.find(".tqb-nav-button").addClass("tqb-disabled")):s.find(".tqb-active-answer").length<this.question.getAllowedAnswers()&&(this.$el.addClass("tqb-active-answer").find(".tqb-answer-action").addClass("tqe-selected-answer"),o.find(".tqb-nav-button").not(".tqb-prev-button").removeClass("tqb-disabled"),s.find(".tqb-active-answer").length===this.question.getAllowedAnswers()&&i.not(".tqb-active-answer").addClass("tqb-disable-answer")),this.shortcode.shouldShowNavButtons()&&this.shortcode.shouldDisplayFeedbackUntilNext()&&a.addClass("tqb-disabled"),void this.question.set("answersEdited",!0)}if(this.shortcode.shouldShowNavButtons()&&(this.collection.trigger("tqb:deselect_active_answers"),this.collection.trigger("tqb:enable_next"),this.question.set("answersEdited",!0)),(this.showNextButton()||this.question.isOpenEndedType()||this.shortcode.shouldDisplayFeedbackUntilNext())&&(this.collection.trigger("tqb:show_nav_buttons"),this.collection.trigger("tqb:enable_next")),"BUTTON"!==e.target.tagName&&!n(e.target).is(".tqb-next-icon")||(this.model.set("answer_text",this.$("textarea").val()),!1!==this.model.isValid(this.question.get("settings")))){var d=e.currentTarget.classList.contains("tqb-open-ended-wrapper");if(d=(d=d&&"BUTTON"!==e.target.tagName)&&!n(e.target).is(".tqb-next-icon"))return e.stopPropagation();this.$el.data("clicked")||(this.$el.attr("data-clicked",1),this.handleProgress()&&!this.shortcode.shouldShowNavButtons()&&this.collection.trigger("tqb:handle_progress",this.model),this.$el.find(".tqb-answer-action").addClass("tqe-selected-answer"),this.$el.addClass("tqb-active-answer"),this.question.isOpenEndedType()||(this.shortcode.shouldShowNavButtons()||this.collection.trigger("tqb:disable_answer",this.model),(this.shortcode.shouldDisplayFeedbackUntilNext()||this.shortcode.shouldDisplayFeedbackUntilTime()&&!this.shortcode.shouldShowNavButtons())&&(this.highlightAnswer(),this.handleFeedback())),this.shortcode.shouldShowNavButtons()||this.shortcode.shouldDisplayFeedbackUntilNext()||this.next())}else this.$("textarea").focus()},next:function(){if(!this.showNextButton()){var e=this;setTimeout((function(){e.model.trigger("tqb:choose_answer",e.model)}),this.getTimeBeforeNextQuestion())}},getTimeBeforeNextQuestion:function(){var e=(this.model.highlightAnswer()||this.model.showFeedback())&&this.question.showFeedback(),t=!this.question.isOpenEndedType()&&e?this.model.getTimeBeforeNextQuestion():0;return"right_wrong"!==this.quiz_type||0!==t||this.model.highlight().loadNext()||this.question.isOpenEndedType()||(t=this.model.getShowFeedbackTime()),t},showNextButton:function(){var e=!this.question.isOpenEndedType()&&!this.model.highlight().loadNext();return"right_wrong"===this.quiz_type?e&&this.model.feedback().showNextButton():e&&this.hasFeedback()&&this.model.feedback().showNextButton()&&this.question.showFeedback()},hasFeedback:function(){return this.model.get("feedback")&&this.model.get("feedback").length>0},displayFeedback:function(){return!0===this.question.get("settings").get("display_question_feedback")&&this.model.showFeedback()},highlightAnswer:function(){!1===this.model.highlightAnswer()&&!1===this.question.isOpenEndedType()||this.collection.trigger("tqb:show_right_answer",this.model)},handleFeedback:function(){if(this.displayFeedback()){var e=this,t=this.shortcode.get("chosenAnswers"),i=this.question.get("id"),s=this.question.get("answersEdited");this.renderFeedback(),setTimeout((function(){e.$(".tqb-answer-feedback").removeClass("tqb-hide")}),0),this.showNextButton()||t[i]&&!s||setTimeout((function(){e.$(".tqb-answer-feedback").addClass("tqb-hide")}),this.model.getShowFeedbackTime())}},renderFeedback:function(){if(this.model.hasFeedback()){var e="";_.each(this.model.get("feedback").split("\n"),(function(t){e+='<p class="tqb-feedback-text">'+_.escape(t)+"</p>"}),this),this.$(".tqb-feedback-inner").html(e)}},set_status:function(e){switch(this.$status.removeAttr("class"),e){case"typing":this.$status.addClass("tqb-typing-text");break;case"error":this.$status.addClass("tqb-error-text")}return this.$status.addClass("tqb-answer-status"),this.$status},handleProgress:function(){var e=TQB_Front.quiz_options[this.model.get("quiz_id")];return e.progress_settings&&1===e.progress_settings.display_progress}}),ThriveQuizB.views.ResultRedirect=ThriveQuizB.views.Base.extend({template:ThriveQuizB.tpl("result-redirect"),events:{"click .tqb-restart-quiz":"restartQuiz","click .tqb-show-results":"redirectToResultURL"},initialize:function(e){this.ShortcodeView=e.view},restartQuiz:function(e){this.ShortcodeView.restartQuiz(e)},redirectToResultURL:function(e){this.ShortcodeView.redirectToResultURL()},render:function(){return this.$el.html(this.template({model:this.model})),this}}),ThriveQuizB.views.ProgressBar=Backbone.View.extend({template:function(e){return e._template&&e._template.length?e._template(e):ThriveQuizB.tpl("progress-bar-skin-"+TQB_Front.quiz_options[this.quizId].quiz_style)(e)},initialize:function(e){this._template=e.template,this.shortcode=e.shortcode,this.flows=e.flows,this.hasSelectedAnswer=e.hasSelectedAnswer,this.quizId=e.quizId},render:function(){var e=this.model.get("percentage"),t=!0!==this.hasSelectedAnswer?Math.round((100-this.model.get("percentage"))/this.getHighestCount()):0,i=100-this.model.get("percentage")>t?Math.round(100-t-this.model.get("percentage")):0,s=n(this.template({_template:this._template,model:this.model,completed:e,estimatedProgress:t,remaining:i}));return this.shortcode.hasQnaTpl()?(this.$el.attr("data-css",s.attr("data-css")),this.$el.html(s.html())):this.$el.html(s[0].outerHTML),this.$(".tqb-progress-completed").css("background-color",this.model.get("fill_color")),this.$(".tqb-progress-label").css("color",this.model.get("label_color")),this.$(".tqb-progress-label, .tqb-next-item, .tqb-remaining-progress").css("font-size",parseInt(this.model.get("font_size"))),this.$(".tqb-next-item").css("background-color",this.model.get("next_step_color")),this.$(".tqb-remaining-progress").css({width:"calc("+i+"%)","background-color":this.model.get("background_color")}),this.$(".tqb-next-item").toggleClass("tqb-hide",!0===this.hasSelectedAnswer),this.$el.removeClass("tqb-hide"),this},getHighestCount:function(e){var t=1;return e=e||this.flows,Object.keys(e).forEach((function(i){e[i].count>t&&(t=e[i].count)})),t}})}))}(jQuery)})()})();;
